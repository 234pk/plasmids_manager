# 序列操作功能可行性分析

> 创建时间：2026-02-04

---

## 背景

用户希望为质粒管理系统添加 **序列操作功能**（类似 SnapGene），包括：
- 序列查看和编辑
- 酶切位点分析
- 引物设计
- 序列比对
- 质粒图谱可视化

---

## 可行性分析

### 方案 1：集成现有 Web 工具（推荐 ⭐⭐⭐⭐⭐）

**方案**：在 Electron 中嵌入 Web 序列编辑器

**候选工具**：

| 工具 | 特点 | 授权 | Web 版 |
|------|------|------|--------|
| **Benchling** | 功能最强，云端 | 商业 | ✅ |
| **ApE** | 免费，功能全 | GPL | ❌ |
| **Serial Cloner** | 免费，简洁 | 免费 | ❌ |
| **SnapGene Web** | SnapGene 官方 | 商业 | ✅ |
| **Geneious Prime** | 综合性强 | 商业 | ✅ |

**实现方式**：
```javascript
// 在 Electron 中打开外部链接
shell.openExternal('https://benchling.com/your-workspace');
```

**优点**：
- 零开发成本
- 功能完整
- 持续更新

**缺点**：
- 需要网络
- 数据不在本地
- 需要付费（部分工具）

---

### 方案 2：集成开源 JS 库（推荐 ⭐⭐⭐⭐）

**方案**：使用 BioJS 或其他开源库

**候选库**：

| 库名称 | 功能 | GitHub Stars | 最后更新 |
|--------|------|--------------|----------|
| **BioJS** | 综合生物信息学 | ~2K | 2023 |
| **bio-sequencing** | 序列处理 | 低 | 2022 |
| **primers-core** | 引物设计 | 低 | 2021 |
| **dna-utils** | DNA 工具 | 低 | 2022 |
| **enzyme-kit** | 酶切分析 | 低 | 2023 |

**BioJS 示例**：
```javascript
// 序列分析
const BioSeq = require('biojs-io').Sequence;

// 酶切分析
const enzyme = require('biojs-enzymes');

// 序列可视化
const MSA = require('biojs-msa');
```

**可用库**：
- **BioJS** - https://github.com/biojs/biojs
- **biojs** - https://www.npmjs.com/package/biojs
- **enzymedb** - 酶数据库

**优点**：
- 免费开源
- 可离线使用
- 可自定义

**缺点**：
- 功能有限（远不如 SnapGene）
- 文档不完善
- 社区不活跃
- 序列可视化能力弱

---

### 方案 3：集成桌面软件（推荐 ⭐⭐⭐）

**方案**：调用本地安装的桌面软件

**候选软件**：

| 软件 | 特点 | 命令行 |
|------|------|--------|
| **SnapGene** | 行业标准 | ❌ 无 |
| **ApE** | 免费 | ❌ 无 |
| **Serial Cloner** | 免费 | ❌ 无 |
| **Benchling CLI** | 云端 CLI | ✅ 有 |
| **DNASTAR** | 商业 | ✅ 有 |

**实现方式**：
```javascript
// Electron 中调用本地软件
const { exec } = require('child_process');

function openInSnapGene(filePath) {
    exec(`"C:\\Program Files\\SnapGene\\SnapGene.exe" "${filePath}"`);
}
```

**优点**：
- 功能完整
- 用户已熟悉

**缺点**：
- 需要用户安装额外软件
- 无法在 Web 界面中嵌入
- SnapGene 无命令行支持

---

### 方案 4：自研序列编辑器（❌ 不推荐）

**方案**：从零开发序列编辑器

**所需功能**：
- 序列渲染（FASTA/GenBank 格式）
- 酶切位点分析
- 图谱可视化
- 引物设计
- 序列比对
- 突变编辑

**工作量评估**：
- 基础功能：2-3 个月
- 完整功能：6-12 个月
- 维护成本：高

**结论**：❌ 不推荐，除非有充足资源

---

## 推荐方案

### 组合方案：本地 + 云端

```
┌─────────────────────────────────────────────────────────┐
│  质粒管理系统                                        │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  [查看序列] ──→ 内嵌简易查看器 (BioJS)                 │
│                  ↓                                      │
│                  如果需要高级功能 →                     │
│                  [在浏览器中打开] → Benchling/SnapGene  │
│                                                         │
│  [编辑序列] ──→ 提示用户选择本地软件                   │
│                  (SnapGene / ApE / Serial Cloner)      │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 具体实现建议

### 1. 基础功能（BioJS 可实现）

| 功能 | 实现难度 | BioJS 支持 |
|------|----------|------------|
| 序列显示 | 低 | ✅ 基础 |
| 序列搜索 | 低 | ✅ 基础 |
| 格式转换 | 低 | ✅ 基础 |
| 序列比对 | 中 | ⚠️ 需额外库 |
| 酶切分析 | 中 | ⚠️ 需 enzyme-kit |
| 引物设计 | 高 | ❌ 需自研 |
| 图谱可视化 | 高 | ❌ 需自研 |

### 2. 集成 Benchling（推荐）

**步骤**：
1. 注册 Benchling 开发者账号
2. 获取 API Key
3. 实现 OAuth 登录
4. 嵌入 WebView 或跳转浏览器

```javascript
// Electron 中嵌入 Benchling
const { BrowserView } = require('electron');

const benchlingView = new BrowserView();
benchlingView.webContents.loadURL('https://benchling.com');

win.addBrowserView(benchlingView);
benchlingView.setBounds({ x: 0, y: 0, width: 800, height: 600 });
```

### 3. 本地查看器（BioJS）

```javascript
// 简易序列查看器
function viewSequence(sequence) {
    // 显示序列长度、GC含量、格式转换
    const analysis = {
        length: sequence.length,
        gcContent: (sequence.match(/[GC]/gi).length / sequence.length * 100).toFixed(2),
        format: 'FASTA',
        aCount: (sequence.match(/A/gi) || []).length,
        tCount: (sequence.match(/T/gi) || []).length,
        cCount: (sequence.match(/C/gi) || []).length,
        gCount: (sequence.match(/G/gi) || []).length
    };
    return analysis;
}

// 格式转换
function convertFormat(sequence, fromFormat, toFormat) {
    // FASTA ↔ GenBank ↔ plain
}
```

---

## 风险与挑战

| 风险 | 等级 | 应对措施 |
|------|------|----------|
| 开源库功能不足 | 中 | 与 Benchling 互补 |
| 云端服务依赖网络 | 中 | 提供本地备选 |
| 序列数据安全 | 低 | 本地优先，云端可选 |
| 开发成本高 | 高 | 采用集成方案 |
| 第三方 API 变更 | 低 | 隔离调用逻辑 |

---

## 结论

### 推荐实现路径

```
第1阶段：简易查看器
├─ 序列长度/GC含量
├─ 格式转换 (FASTA/GenBank)
└─ 序列搜索
    ↓
第2阶段：酶切分析
├─ 常见限制酶识别
├─ 酶切位点标注
└─ 片段大小计算
    ↓
第3阶段：高级集成
├─ Benchling 集成
└─ SnapGene 本地调用
```

### 优先级

| 优先级 | 功能 | 方案 |
|--------|------|------|
| P0 | 序列显示/搜索 | BioJS |
| P0 | 格式转换 | BioJS |
| P1 | 酶切分析 | enzyme-kit |
| P1 | 引物设计 | Benchling |
| P2 | 图谱可视化 | Benchling |
| P2 | 序列比对 | Benchling |

---

## 下一步

1. **确认需求**：哪些功能是必须的？
2. **选择方案**：简易查看器 + Benchling 集成？
3. **技术选型**：确认使用的库和 API
4. **原型开发**：先实现基础功能
