const fs = require('fs');
const path = require('path');

const translationsPath = path.join(__dirname, 'js', 'translations_data.js');
const content = fs.readFileSync(translationsPath, 'utf8');

// 增强词典，包含更多常用词汇和短语
const dictionary = {
    "质粒管理系统": "Plasmid Management System",
    "增强编辑版": "Enhanced Edition",
    "质粒库": "Plasmid Library",
    "项目管理": "Project Management",
    "持有人管理": "Holder Management",
    "文件名": "File Name",
    "载体类型": "Vector Type",
    "靶基因": "Target Gene",
    "物种": "Species",
    "功能": "Function",
    "大肠杆菌抗性": "E.coli Resistance",
    "哺乳动物抗性": "Mammalian Resistance",
    "插入类型": "Insert Type",
    "蛋白标签": "Protein Tag",
    "荧光蛋白": "Fluorescent Protein",
    "启动子": "Promoter",
    "突变": "Mutation",
    "四环素诱导": "Tet Inducible",
    "保存位置": "Location",
    "持有人": "Holder",
    "项目": "Project",
    "添加时间": "Added Time",
    "更新时间": "Updated Time",
    "描述": "Description",
    "序列": "Sequence",
    "保存": "Save",
    "取消": "Cancel",
    "确定": "Confirm",
    "搜索": "Search",
    "编辑": "Edit",
    "删除": "Delete",
    "导入": "Import",
    "导出": "Export",
    "设置": "Settings",
    "日志": "Logs",
    "新建": "New",
    "成功": "Success",
    "失败": "Error",
    "提示": "Tip",
    "警告": "Warning",
    "加载中": "Loading",
    "暂无数据": "No Data",
    "显示": "Show",
    "隐藏": "Hide",
    "全部": "All",
    "条记录": "records",
    "上一页": "Prev",
    "下一页": "Next",
    "路径": "Path",
    "绝对路径": "Absolute Path",
    "欢迎使用": "Welcome to",
    "跳过引导": "Skip Guide",
    "上一步": "Prev Step",
    "下一步": "Next Step",
    "立即开启": "Start Now",
    "方式一": "Method 1",
    "方式二": "Method 2",
    "方式三": "Method 3",
    "从零开始": "Start from Scratch",
    "创建示例数据库": "Create Sample DB",
    "导入现有数据库": "Import Existing DB",
    "选择文件": "Select File",
    "每页显示条数": "Rows per page",
    "表格密度": "Density",
    "紧凑": "Compact",
    "舒适": "Comfortable",
    "排序方式": "Sort by",
    "升序": "Ascending",
    "降序": "Descending",
    "清除所有筛选": "Clear all filters",
    "当前筛选": "Current Filters",
    "操作": "Actions",
    "查看序列": "View Sequence",
    "复制序列": "Copy Sequence",
    "关闭": "Close",
    "系统日志": "System Logs",
    "清空日志": "Clear Logs",
    "批量导入": "Batch Import",
    "确认导入": "Confirm Import",
    "正在启动": "Starting",
    "正在初始化": "Initializing",
    "语言设置": "Language",
    "界面语言": "UI Language",
    "中文": "Chinese",
    "英语": "English",
    "专业特征": "Professional Features",
    "识别结果": "Recognition Results",
    "查重": "Check Duplicates",
    "覆盖更新": "Overwrite Update",
    "新增记录": "Add New Record",
    "更新现有记录": "Update Existing Record",
    "同步至本地": "Sync to local",
    "暂存至缓存": "Saved to cache",
    "无法打开": "Cannot open",
    "文件路径无效": "Invalid file path",
    "质粒名称": "Plasmid Name",
    "载体": "Vector",
    "抗性": "Resistance",
    "蛋白": "Protein",
    "标签": "Tag",
    "荧光": "Fluorescence",
    "诱导": "Inducible",
    "类型": "Type",
    "位置": "Location",
    "人员": "Person",
    "信息": "Information",
    "特征": "Features",
    "分类": "Category",
    "存储": "Storage",
    "时间": "Time",
    "文件": "File",
    "数据库": "Database",
    "文件夹": "Folder",
    "物理路径": "Physical Path",
    "自动识别": "Auto Recognition",
    "批量粘贴": "Batch Paste",
    "单条录入": "Single Entry",
    "筛选": "Filter",
    "排序": "Sort",
    "分页": "Pagination",
    "第": "Page ",
    "页": "",
    "条": " items",
    "共": "Total ",
    "帮助": "Help",
    "引导": "Guide",
    "完成": "Finished",
    "开启": "Open",
    "修改": "Modify",
    "查看": "View",
    "刷新": "Refresh",
    "重置": "Reset",
    "更多": "More",
    "操作成功": "Operation Successful",
    "操作失败": "Operation Failed",
    "确定要": "Are you sure to ",
    "吗": "?",
    "请输入": "Please enter ",
    "请选择": "Please select ",
    "不能为空": " cannot be empty",
    "已存在": " already exists",
    "不存在": " does not exist",
    "不合法": " is invalid",
    "格式错误": " format error",
    "网络错误": "Network error",
    "系统错误": "System error",
    "数据加载中": "Data loading...",
    "暂无": "No ",
    "数据": "data",
    "结果": "results",
    "个": " ",
    "条": " ",
    "当 Vue 挂载完成": "When Vue is mounted",
    "移除）后": "After removal",
    "隐藏加载层": "Hide loading layer",
    "交互美化": "UI Enhancement",
    "引导层样式": "Guide layer style",
    "自定义滚动条 - 增强可见性": "Custom scrollbar - Enhanced visibility",
    "列宽调整手柄": "Column width resize handle",
    "使用 100vh 让手柄延伸到整个表格高度": "Use 100vh to extend handle to full table height",
    "方便拖拽": "Convenient dragging",
    "防止过高": "Prevent too high",
    "默认隐藏": "Hidden by default",
    "激活时加宽，方便抓取": "Widen when active for easy grabbing",
    "居中显示": "Centered display",
    "用户引导": "User Guide",
    "新用户引导界面": "New User Guide Interface",
    "看起来您是第一次使用，让我们快速上手": "It looks like this is your first time, let's get started quickly",
    "拖入 plasmid_database.json": "Drag in plasmid_database.json",
    "或点击选择文件": "Or click to select file",
    "推荐": "Recommended",
    "立即体验全部功能": "Experience all features now",
    "包含 5 个示例质粒": "Includes 5 sample plasmids",
    "加载示例": "Load samples",
    "手动创建您的第一个质粒": "Manually create your first plasmid",
    "建立全新的数据库": "Establish a brand new database",
    "创建空白库": "Create empty library",
    "隐藏的文件输入框": "Hidden file input",
    "主界面": "Main Interface",
    "左侧：核心操作": "Left: Core Actions",
    "右侧：工具与系统": "Right: Tools & System",
    "视图设置": "View Settings",
    "显示设置": "Display Settings",
    "列显示": "Column Display",
    "界面缩放": "Interface Zoom",
    "重置默认大小": "Reset Default Size",
    "数据工具": "Data Tools",
    "系统操作": "System Operations",
    "保存数据库": "Save Database",
    "更多菜单": "More Menu",
    "更多操作": "More Actions",
    "新建数据库": "New Database",
    "切换数据库": "Switch Database",
    "视图切换": "View Switch",
    "主视图": "Main View",
    "项目列表": "Project List",
    "新建项目": "New Project",
    "个质粒": " plasmids",
    "编辑项目": "Edit Project",
    "删除项目": "Delete Project",
    "暂无项目": "No Projects",
    "持有人列表": "Holder List",
    "新建持有人": "New Holder",
    "删除持有人": "Delete Holder",
    "暂无持有人数据": "No Holder Data",
    "主内容区": "Main Content",
    "顶部搜索": "Top Search",
    "移除关联": "Remove Association",
    "清空项目": "Clear Project",
    "清空关联": "Clear Association",
    "清空持有人": "Clear Holder",
    "清空搜索": "Clear Search",
    "输入任何关键词": "Enter any keywords",
    "全部显示": "Show All",
    "顺序": "Order",
    "仅在质粒库视图显示高级筛选": "Show advanced filters only in Plasmid Library view",
    "高级筛选": "Advanced Filter",
    "收起筛选": "Collapse Filter",
    "展开筛选": "Expand Filter",
    "常用筛选": "Common Filters",
    "最近添加": "Recently Added",
    "未归类质粒": "Uncategorized Plasmids",
    "有序列记录": "Records with Sequence",
    "无序列记录": "Records without Sequence",
    "载体类型": "Vector Type",
    "物种/来源": "Species/Source",
    "抗性 (大肠杆菌)": "Resistance (E.coli)",
    "抗性 (哺乳动物)": "Resistance (Mammalian)",
    "启动子": "Promoter",
    "蛋白标签": "Protein Tag",
    "荧光蛋白": "Fluorescent Protein",
    "清除": "Clear",
    "数据表格": "Data Table",
    "复制": "Copy",
    "外部打开": "Open Externally",
    "导出 CSV": "Export CSV",
    "导出 JSON": "Export JSON",
    "批量删除": "Batch Delete",
    "批量更新": "Batch Update",
    "已选中": "Selected",
    "条记录": "records",
    "取消选中": "Deselect",
    "确定要批量删除选中的": "Are you sure to batch delete selected ",
    "条记录吗？": " records?",
    "批量更新字段": "Batch Update Fields",
    "请选择要统一修改的字段": "Please select fields to modify collectively",
    "新值": "New Value",
    "请输入新值...": "Please enter new value...",
    "正在更新": "Updating",
    "更新成功": "Update Successful",
    "个质粒详情": " plasmid details",
    "质粒详情": "Plasmid Details",
    "基本信息": "Basic Info",
    "特征分类": "Feature Category",
    "抗性信息": "Resistance Info",
    "序列与路径": "Sequence & Path",
    "所属项目": "Belongs to Project",
    "关联项目": "Associated Projects",
    "添加项目": "Add Project",
    "移除": "Remove",
    "暂无关联项目": "No associated projects",
    "时间信息": "Time Info",
    "备注描述": "Remarks/Description",
    "点击查看完整序列": "Click to view full sequence",
    "查看完整序列": "View Full Sequence",
    "暂无序列信息": "No sequence info",
    "在 SnapGene 中打开": "Open in SnapGene",
    "在 Benchling 中打开": "Open in Benchling",
    "复制序列": "Copy Sequence",
    "复制成功": "Copied successfully",
    "搜索弹窗": "Search Popup",
    "搜索:": "Search:",
    "正在查询 UniProt 数据库": "Querying UniProt database",
    "官网": "Official Website",
    "功能描述": "Function Description",
    "分子量": "Molecular Weight",
    "序列长度": "Sequence Length",
    "蛋白序列预览": "Protein Sequence Preview",
    "填入数据到": "Fill data into",
    "未找到匹配结果": "No matches found",
    "请尝试更精确的基因名称": "Please try a more precise gene name",
    "项目管理弹窗": "Project Management Popup",
    "项目管理中心": "Project Management Center",
    "左侧：项目列表": "Left: Project List",
    "搜索项目...": "Search projects...",
    "无描述": "No description",
    "右侧：项目详情": "Right: Project Details",
    "质粒列表": "Plasmid List",
    "暂无描述": "No description",
    "关联质粒清单 (": "Associated Plasmid List (",
    "从项目中移除": "Remove from Project",
    "暂无关联质粒": "No associated plasmids",
    "请在左侧选择一个项目查看详情": "Please select a project on the left to view details",
    "新建/编辑项目表单弹窗": "New/Edit Project Form Popup",
    "编辑项目' : '新建项目": "'Edit Project' : 'New Project'",
    "项目名称": "Project Name",
    "例如：癌症研究": "e.g., Cancer Research",
    "项目描述": "Project Description",
    "简要描述项目目标...": "Briefly describe project goals...",
    "项目成员": "Project Members",
    "移除成员": "Remove Member",
    "输入新成员或选择": "Enter new member or select",
    "编辑弹窗": "Edit Popup",
    "修改质粒信息": "Modify Plasmid Info",
    "模式切换 Tabs (仅在新建时显示": "Mode Switch Tabs (Shown only when creating",
    "批量粘贴视图": "Batch Paste View",
    "批量导入说明": "Batch Import Instructions",
    "请将质粒名称粘贴到下方文本框中": "Please paste plasmid names into the text box below",
    "每行一个名称，系统将自动识别属性": "One name per line, the system will automatically recognize attributes",
    "所有新创建的质粒将使用下方设置的默认持有人和项目": "All newly created plasmids will use the default holder and project set below",
    "质粒名称列表 (每行一个": "Plasmid Name List (one per line",
    "例如：": "e.g.:",
    "默认持有人": "Default Holder",
    "默认项目": "Default Project",
    "单条编辑视图": "Single Edit View",
    "用逗号隔开": "Separated by commas",
    "如 shRNA, cDNA": "e.g., shRNA, cDNA",
    "如 Flag, Myc, His": "e.g., Flag, Myc, His",
    "如 EGFP, mCherry": "e.g., EGFP, mCherry",
    "如 CMV, EF1a, U6": "e.g., CMV, EF1a, U6",
    "是/否": "Yes/No",
    "或 诱导剂": "or Inducer",
    "描述突变位点": "Describe mutation sites",
    "质粒序列 (ATCG": "Plasmid Sequence (ATCG",
    "序列...": "Sequence...",
    "完整路径": "Full Path",
    "描述说明": "Description",
    "冰箱A-层": "Fridge A - Shelf ",
    "盒3": "Box 3",
    "持有人 = settings.defaultOwner": "Holder = settings.defaultOwner",
    "使用默认": "Use Default",
    "设为默认": "Set as Default",
    "输入新名字并保存即自动创建新持有人": "Enter a new name and save to automatically create a new holder",
    "立即新建": "Create Now",
    "智能识别": "Smart Recognition",
    "显示预览确认界面，而不是直接保存": "Show preview confirmation instead of direct save",
    "已解析 $": "Parsed $",
    "条数据，请确认后导入": " records, please confirm and import",
    "查重逻辑": "Duplicate Check Logic",
    "简单查重：检查文件名是否已存在": "Simple check: whether the file name already exists",
    "可以选择跳过，或者重命名": "You can choose to skip or rename",
    "自动在名字后面加 (1": "Automatically add (1) after the name",
    "更新识别信息中可能依赖名字的字段? 不": "Update fields that may depend on the name? No",
    "识别已经完成": "Recognition completed",
    "条重名已自动重命名)`);": " duplicates automatically renamed)`);",
    "监听文件名变化，进行智能识别": "Listen for file name changes for smart recognition",
    "序列查看器相关": "Sequence Viewer Related",
    "序列文件": "Sequence File",
    "批量导入相关": "Batch Import Related",
    "严格检查 Electron 环境": "Strictly check Electron environment",
    "防止在普通浏览器或某些代理环境下误判": "Prevent misjudgment in normal browsers or proxy environments",
    "只有在 Electron 环境下才允许直接劫持日志": "Direct log hijacking is allowed only in Electron environment",
    "数据库连接状态": "Database Connection Status",
    "这是一个专为科研人员设计的质粒管理系统": "This is a plasmid management system designed for researchers",
    "它不仅能帮您记录质粒，还能自动从文件中提取序列和特征": "It not only records plasmids but also extracts sequences and features from files",
    "让我们花 1 分钟了解如何高效使用": "Let's spend 1 minute learning how to use it efficiently",
    "快速导入', content: '点击": "Quick Import', content: 'Click ",
    "批量导入”可以直接扫描整个文件夹": "Batch Import' to scan the entire folder",
    "系统会智能识别文件名中的抗性、启动子等信息": "The system will intelligently recognize resistance, promoter, etc. from file names",
    "并自动关联 .dna/.gb 文件": "and automatically associate .dna/.gb files",
    "极速搜索', content: '您可以按文件名": "Fast Search', content: 'You can search by file name, ",
    "靶基因、抗性或项目进行多维度搜索": "target gene, resistance, or project in multiple dimensions",
    "支持拼音首字母搜索，找质粒从未如此简单": "Supports Pinyin initial search, finding plasmids has never been easier",
    "项目管理', content: '将质粒归类到不同的项目中": "Project Management', content: 'Categorize plasmids into different projects",
    "点击这里可以切换到项目视角，查看每个项目的质粒清单和成员": "Click here to switch to project view and see each project's plasmid list and members",
    "持有人视图', content: '想知道某个成员手里有多少质粒": "Holder View', content: 'Want to know how many plasmids a member has?",
    "切换到持有人视图，按人员进行归类 and 管理": "Switch to holder view to categorize and manage by person",
    "操作记录', content: '所有的修改都会被记录下来": "Operation Logs', content: 'All modifications will be recorded",
    "点击这里可以查看系统日志，追踪每一条数据的变动": "Click here to view system logs and track changes to every piece of data",
    "深度定制', content: '在设置中": "Deep Customization', content: 'In settings, ",
    "您可以配置默认持有人、修改识别规则": "you can configure default holder and modify recognition rules",
    "开启/关闭自动序列保存功能": "enable/disable automatic sequence saving",
    "准备就绪', content: '引导结束": "Ready', content: 'Guide finished",
    "现在您可以开始建立您的实验室质粒库了。如有疑问": "Now you can start building your lab plasmid library. If you have questions,",
    "可以随时在设置中重新开启引导。', target: null": "you can restart the guide in settings at any time.', target: null",
    "清除之前的提示": "Clear previous tips",
    "保存设置": "Save Settings",
    "批量创建相关": "Batch Creation Related",
    "维护] 开始重新生成序列文件": "Maintenance] Start regenerating sequence files",
    "正在后台处理 $": "Processing $ in background...",
    "个文件...`, 'INFO": " files...`, 'INFO",
    "优先级 1: 从文件路径读取": "Priority 1: Read from file path",
    "优先级 2: 从系统内存": "Priority 2: Read from system memory",
    "数据库读取 (如果文件读取失败或无路径": "Database read (if file read fails or no path",
    "更新内存中的序列": "Update sequence in memory",
    "如果是从文件读取，且是": "If read from file and it is ",
    "或 .gb 文件": " or .gb file",
    "尝试转换为标准 XML-GB 格式": "Try converting to standard XML-GB format",
    "强制转换并保存为 .gb (包含": "Force convert and save as .gb (including ",
    "特性": "features",
    "如果没有转换保存 (例如是从": "If not converted and saved (e.g., read from ",
    "读取，或转换失败": " read, or conversion failed",
    "或来自内存)，则保存为默认格式": " or from memory), save in default format",
    "维护] 进度": "Maintenance] Progress",
    "维护] 完成": "Maintenance] Finished",
    "处理完成：成功生成": "Processing finished: successfully generated ",
    "个序列文件`);": " sequence files`);",
    "导出功能": "Export Function",
    "数据已导出 JSON": "Data exported to JSON",
    "导出] 数据库为空": "Export] Database is empty",
    "取消导出', 'WARN": "Cancel export', 'WARN",
    "导出] 未选择任何导出字段": "Export] No export fields selected",
    "请至少选择一个导出字段', 'WARN": "Please select at least one export field', 'WARN",
    "导出] 正在导出": "Export] Exporting ",
    "条记录至 CSV (字段": " records to CSV (fields ",
    "导出] CSV 文件已生成": "Export] CSV file generated",
    "已导出 $": "Exported $",
    "条数据到 CSV`);": " records to CSV`);",
    "导出] 导出失败": "Export] Export failed",
    "导入] 收到": "Import] Received ",
    "导入请求: $": " import request: $",
    "导入] 解析": "Import] Parsing ",
    "查重并合并": "Check duplicates and merge",
    "导入] 合并完成": "Import] Merge finished",
    "新增 $": "Added $",
    "条, 更新": " records, updated ",
    "导入] 正在同步数据库文件": "Import] Syncing database file",
    "导入] 数据库文件同步成功": "Import] Database file synced successfully",
    "导入] 数据库文件同步失败": "Import] Database file sync failed",
    "导入成功：新增": "Import successful: Added ",
    "条，更新": " records, updated ",
    "导入] CSV 文件内容为空或格式不正确": "Import] CSV file content empty or incorrect format",
    "文件内容为空或格式错误', 'ERROR": "File content empty or format error', 'ERROR",
    "导入] 发生错误": "Import] Error occurred",
    "导入 CSV 失败": "Import CSV failed",
    "请检查文件格式', 'ERROR": "Please check file format', 'ERROR",
    "清除 input 值": "Clear input value",
    "方便下次选择同一文件": "Convenient for selecting the same file next time",
    "编辑功能": "Edit Function",
    "开始编辑质粒: $": "Start editing plasmid: $",
    "如果是 Electron 环境且没有序列信息": "If Electron environment and no sequence info",
    "尝试从本地加载": "Try loading from local",
    "编辑] 正在保存修改": "Edit] Saving modifications",
    "最终保存前的查重": "Duplicate check before final save",
    "批量导入] 正在写入数据库": "Batch Import] Writing to database ",
    "条...`);": " records...`);",
    "更新项目关联": "Update project association",
    "批量导入] 成功同步至本地": "Batch Import] Successfully synced to local ",
    "条 (序列保存": " records (sequence saved ",
    "条质粒`;": " plasmids`;",
    "条重复记录`;": " duplicate records`;",
    "批量导入] 无新记录可导入": "Batch Import] No new records to import",
    "条重复)`, 'INFO": " duplicate)`, 'INFO",
    "条重复记录`);": " duplicate records`);",
    "批量更新] 准备更新": "Batch Update] Preparing update",
    "请至少选择一条记录进行更新": "Please select at least one record to update",
    "识别引擎与规则加载": "Recognition engine and rules loading",
    "增强": "Enhanced",
    "确保 Service 已加载": "Ensure Service is loaded",
    "检查是否有靶基因且未手动填写 UniProtID": "Check for target gene without manual UniProtID",
    "查询蛋白信息...`);": " querying protein info...`);",
    "命中: $": "Hit: $",
    "返回增强后的对象 (不修改原对象": "Return enhanced object (no modification to original",
    "模糊匹配与变体": "Fuzzy matching and variants",
    "相似度匹配（使用": "Similarity matching (using ",
    "距离）": " distance)",
    "模糊匹配函数": "Fuzzy matching function",
    "变体匹配": "Variant matching",
    "相似度匹配": "Similarity matching",
    "识别] 名称模型已更新": "Recognition] Name model updated",
    "数: $": " count: $",
    "识别] 名称模型更新失败": "Recognition] Name model update failed",
    "推断规则 (Inference Rules": "Inference Rules",
    "敲降': [": "'Knockdown': [",
    "敲除/编辑": "Knockout/Edit",
    "过表达/功能载体": "Overexpression/Functional Vector",
    "病毒包装载体': [": "'Viral Packaging Vector': [",
    "表达': [": "'Expression': [",
    "空载体': [": "'Empty Vector': [",
    "慢病毒包装':": "Lentiviral Packaging':",
    "人': /^[A-Z": "'Human': /^[A-Z",
    "小鼠': /^[A-Z][a-z": "'Mouse': /^[A-Z][a-z",
    "大鼠': /^[A-Z][a-z": "'Rat': /^[A-Z][a-z",
    "果蝇',": "Drosophila',",
    "大肠杆菌',": "E.coli',",
    "哺乳动物',": "Mammal',",
    "人', 'GAPDH': '人": "Human', 'GAPDH': 'Human",
    "人', 'HNRNPA1': '人": "Human', 'HNRNPA1': 'Human",
    "小鼠', 'Gapdh': '小鼠": "Mouse', 'Gapdh': 'Mouse",
    "小鼠', 'Hnrnp': '小鼠": "Mouse', 'Hnrnp': 'Mouse",
    "哺乳动物', 'Bace1': '哺乳动物": "Mammal', 'Bace1': 'Mammal",
    "学习功能": "Learning Function",
    "简单的规则：记住这个修正": "Simple rule: remember this correction",
    "特征解析 (更精准": "Feature parsing (more precise",
    "提取特征值 /label=": "Extract feature value /label=",
    "收集所有可能的文本信息": "Collect all possible text info",
    "启动子检测": "Promoter detection",
    "尝试提取具体的启动子名称，而不是仅仅": "Try extracting specific promoter name instead of just ",
    "标签检测": "Tag detection",
    "插入类型检测 (shRNA/miRNA/ORF": "Insert type detection (shRNA/miRNA/ORF",
    "抗性检测 (Fallback for GenBank features": "Resistance detection (Fallback for GenBank features",
    "结合文件名推断 (Name Fallback / Merge": "Combine with file name inference (Name Fallback / Merge",
    "策略：优先信赖文件内容": "Strategy: Prioritize file content",
    "但如果内容缺失关键信息，使用文件名识别结果补充": "But if content lacks key info, supplement with file name recognition results",
    "合并载体类型": "Merge vector types",
    "合并抗性 (如果内容未找到": "Merge resistance (if not found in content",
    "合并启动子 (如果内容未找到": "Merge promoters (if not found in content",
    "合并标签 (内容识别较弱": "Merge tags (content recognition is weak",
    "通常合并": "Usually merged",
    "合并插入类型": "Merge insert types",
    "如果内容已经识别出 shRNA/miRNA，则不覆盖": "If content already identified shRNA/miRNA, do not overwrite",
    "如果内容为空，或者内容是": "If content is empty or is ",
    "而名字是更具体的，可以合并": " and name is more specific, can merge",
    "合并功能和物种": "Merge function and species",
    "基于载体类型的强制推断 (Content-based Inference": "Force inference based on vector type (Content-based Inference",
    "空载体": "Empty Vector",
    "敲降": "Knockdown",
    "标准化": "Standardization",
    "清理 (移除冗余": "Cleanup (remove redundancy",
    "如: 有": "e.g., have ",
    "则移除 GFP": " then remove GFP",
    "绝对路径": "Absolute Path",
    "载体/物种": "Vector/Species",
    "请输入新的保存位置 (将应用到": "Please enter new location (will apply to ",
    "请输入新的持有人 (将应用到": "Please enter new holder (will apply to ",
    "识别] 手动触发名称识别": "Recognition] Manually trigger name recognition",
    "序列已复制到剪贴板": "Sequence copied to clipboard",
    "打开外部链接": "Open external link",
    "选择外部软件路径 (Electron 专用": "Select external software path (Electron only",
    "生成外部生物信息数据库链接": "Generate external bioinformatics database links",
    "物种映射表：中文名": "Species mapping: Chinese name",
    "英文名, TaxonomyID": "English name, TaxonomyID",
    "哺乳动物": "Mammal",
    "如果不包含中文，直接作为英文名使用": "If no Chinese, use directly as English name",
    "英文名搜索": "English name search",
    "仅搜索基因名": "Search gene name only",
    "确定要删除质粒": "Are you sure to delete plasmid ",
    "吗？此操作不可撤销": "? This action cannot be undone",
    "删除] 正在处理删除请求": "Delete] Processing delete request",
    "删除] 内存记录已移除": "Delete] Memory record removed",
    "删除] 正在同步数据库文件": "Delete] Syncing database file",
    "删除] 成功同步至本地数据库": "Delete] Successfully synced to local database",
    "记录已删除": "Record deleted",
    "删除] 数据库文件同步失败": "Delete] Database file sync failed",
    "删除失败，请重试": "Delete failed, please try again",
    "记录已从缓存中删除": "Record deleted from cache",
    "删除] 未找到匹配记录": "Delete] No matching record found",
    "删除] 发生错误": "Delete] Error occurred",
    "删除失败，请检查日志": "Delete failed, please check logs",
    "批量创建质粒逻辑已在 line 326 定义": "Batch create plasmid logic defined at line 326",
    "此处删除重复定义以修复 SyntaxError": "Delete duplicate definition to fix SyntaxError",
    "识别] 延迟自动识别触发": "Recognition] Delayed auto-recognition triggered",
    "列宽调整逻辑": "Column width adjustment logic",
    "获取列名：取第一个文本节点的去重内容": "Get column name: unique content of the first text node",
    "添加临时样式以防止选中文本和光标闪烁": "Add temporary styles to prevent text selection and cursor flickering",
    "最小宽度 50px": "Min width 50px",
    "强制生效": "Force effect",
    "恢复样式": "Restore style",
    "保存列宽": "Save column width",
    "确定要清空该项目下的所有质粒关联吗？\\\\n注意": "Are you sure to clear all plasmid associations under this project?\\\\nNote",
    "这不会删除质粒，只会移除其项目归属": "This will not delete plasmids, only remove their project affiliation",
    "该项目下没有关联质粒": "No associated plasmids under this project",
    "确定要删除持有人": "Are you sure to delete holder ",
    "吗？\\\\n此操作将": "?\\\\nThis will ",
    "清空所有质粒的该持有人信息\\\\n2. 从常用持有人列表中移除": "Clear this holder info for all plasmids\\\\n2. Remove from common holders list",
    "从所有项目中移除该成员`)) return;": "Remove this member from all projects`)) return;",
    "从所有质粒中移除": "Remove from all plasmids",
    "从自定义持有人列表中移除": "Remove from custom holders list",
    "格式保存: $": " format saved: $",
    "序列已保存: $": "Sequence saved: $",
    "序列保存失败 ($": "Sequence save failed ($",
    "原始序列": "Original Sequence",
    "如果是从文件读取，且是": "If read from file, and is ",
    "尝试转换为标准 XML-GB 格式": "Try converting to standard XML-GB format",
    "强制转换并保存为 .gb (包含": "Force convert and save as .gb (including ",
    "如果没有转换保存 (例如是从": "If not converted and saved (e.g., from ",
    "读取，或转换失败": " read, or conversion failed",
    "或来自内存)，则保存为默认格式": " or from memory), save as default format",
    "导出] CSV 文件已生成": "Export] CSV file generated",
    "导入成功：新增": "Import successful: Added ",
    "条，更新": " records, updated ",
    "文件内容为空或格式错误', 'ERROR": "File empty or format error', 'ERROR",
    "导入 CSV 失败": "Import CSV failed",
    "请检查文件格式', 'ERROR": "Please check format', 'ERROR",
    "编辑功能": "Edit Function",
    "开始编辑质粒: $": "Start editing plasmid: $",
    "编辑] 正在保存修改": "Edit] Saving modifications",
    "最终保存前的查重": "Duplicate check before saving",
    "批量导入] 正在写入数据库": "Batch Import] Writing to database ",
    "条...`);": " records...`);",
    "更新项目关联": "Update project association",
    "批量导入] 成功同步至本地": "Batch Import] Successfully synced ",
    "条 (序列保存": " records (sequence saved ",
    "条质粒`;": " plasmids`;",
    "条重复记录`;": " duplicate records`;",
    "批量导入] 无新记录可导入": "Batch Import] No new records",
    "条重复)`, 'INFO": " duplicate)`, 'INFO",
    "条重复记录`);": " duplicate records`);",
    "批量更新] 准备更新": "Batch Update] Preparing update",
    "请至少选择一条记录进行更新": "Please select at least one record",
    "识别引擎与规则加载": "Recognition engine and rules loading",
    "命中: $": "Hit: $",
    "载体类型', '物种": "'Vector Type', 'Species'",
    "功能', '插入类型": "'Function', 'Insert Type'",
    "蛋白标签', '荧光蛋白": "'Protein Tag', 'Fluorescent Protein'",
    "启动子', '大肠杆菌抗性": "'Promoter', 'E.coli Resistance'",
    "哺乳动物抗性', '四环素诱导": "'Mammalian Resistance', 'Tet Inducible'",
    "识别] 名称模型已更新": "Recognition] Name model updated",
    "识别] 名称模型更新失败": "Recognition] Name model update failed",
    "敲降": "Knockdown",
    "敲除/编辑": "Knockout/Edit",
    "病毒包装载体": "Viral Packaging Vector",
    "慢病毒包装": "Lentiviral Packaging",
    "空载体": "Empty Vector",
    "果蝇": "Drosophila",
    "大肠杆菌": "E.coli",
    "哺乳动物": "Mammal",
    "学习功能": "Learning Function",
    "简单的规则：记住这个修正": "Simple rule: remember this correction",
    "特征解析 (更精准": "Feature parsing (more precise",
    "提取特征值 /label=": "Extract feature value /label=",
    "收集所有可能的文本信息": "Collect all possible text info",
    "启动子检测": "Promoter detection",
    "标签检测": "Tag detection",
    "插入类型检测 (shRNA/miRNA/ORF": "Insert type detection (shRNA/miRNA/ORF",
    "抗性检测 (Fallback for GenBank features": "Resistance detection (Fallback for GenBank features",
    "结合文件名推断 (Name Fallback / Merge": "Combine with file name inference (Name Fallback / Merge",
    "策略：优先信赖文件内容": "Strategy: Prioritize file content",
    "但如果内容缺失关键信息，使用文件名识别结果补充": "But if content lacks key info, supplement with file name recognition results",
    "合并载体类型": "Merge vector types",
    "合并抗性 (如果内容未找到": "Merge resistance (if not found in content",
    "合并启动子 (如果内容未找到": "Merge promoters (if not found in content",
    "合并标签 (内容识别较弱": "Merge tags (content recognition is weak",
    "通常合并": "Usually merged",
    "合并插入类型": "Merge insert types",
    "如果内容已经识别出 shRNA/miRNA，则不覆盖": "If content already identified shRNA/miRNA, do not overwrite",
    "如果内容为空，或者内容是": "If content is empty or is ",
    "而名字是更具体的，可以合并": " and name is more specific, can merge",
    "合并功能和物种": "Merge function and species",
    "基于载体类型的强制推断 (Content-based Inference": "Force inference based on vector type (Content-based Inference",
    "标准化": "Standardization",
    "清理 (移除冗余": "Cleanup (remove redundancy",
    "如: 有": "e.g., have ",
    "则移除 GFP": " then remove GFP",
    "绝对路径": "Absolute Path",
    "载体/物种": "Vector/Species",
    "请输入新的保存位置 (将应用到": "Please enter new location (will apply to ",
    "请输入新的持有人 (将应用到": "Please enter new holder (will apply to ",
    "识别] 手动触发名称识别": "Recognition] Manually trigger name recognition",
    "打开外部链接": "Open external link",
    "选择外部软件路径 (Electron 专用": "Select external software path (Electron only",
    "生成外部生物信息数据库链接": "Generate external bioinformatics database links",
    "如果不包含中文，直接作为英文名使用": "If no Chinese, use directly as English name",
    "英文名搜索": "English name search",
    "仅搜索基因名": "Search gene name only",
    "确定要删除质粒": "Are you sure to delete plasmid ",
    "吗？此操作不可撤销": "? This action cannot be undone",
    "删除失败，请重试": "Delete failed, please try again",
    "删除失败，请检查日志": "Delete failed, please check logs",
    "识别] 延迟自动识别触发": "Recognition] Delayed auto-recognition triggered",
    "列宽调整逻辑": "Column width adjustment logic",
    "获取列名：取第一个文本节点的去重内容": "Get column name: unique content of the first text node",
    "添加临时样式以防止选中文本和光标闪烁": "Add temporary styles to prevent text selection and cursor flickering",
    "最小宽度 50px": "Min width 50px",
    "保存列宽": "Save column width",
    "确定要清空该项目下的所有质粒关联吗？\\\\n注意": "Are you sure to clear all plasmid associations under this project?\\\\nNote",
    "这不会删除质粒，只会移除其项目归属": "This will not delete plasmids, only remove their project affiliation",
    "该项目下没有关联质粒": "No associated plasmids under this project",
    "确定要删除持有人": "Are you sure to delete holder ",
    "吗？\\\\n此操作将": "?\\\\nThis will ",
    "从所有项目中移除该成员`)) return;": "Remove this member from all projects`)) return;",
    "从自定义持有人列表中移除": "Remove from custom holders list"
};

// 提取 zh 对象的内容
const zhMatch = content.match(/zh:\s*\{([\s\S]*?)\},\s*en:/);
if (!zhMatch) {
    console.error('Could not find zh object');
    process.exit(1);
}

const zhStr = zhMatch[1];
const zhEntries = {};
const entryRegex = /"(gen_\d+)":\s*"([\s\S]*?)"/g;
let match;
while ((match = entryRegex.exec(zhStr)) !== null) {
    zhEntries[match[1]] = match[2];
}

const en = {};
for (const [key, val] of Object.entries(zhEntries)) {
    let translated = val;
    
    // 1. 移除可能残留的 [EN]
    translated = translated.replace(/\[EN\]\s*/g, '');
    
    // 2. 特殊处理包含 JS 逻辑或模板的字符串
    if (translated.includes("' : '")) {
        const parts = translated.split("' : '");
        translated = parts.map(p => {
            let inner = p.replace(/^'|'$/g, '');
            for (const [zhWord, enWord] of Object.entries(dictionary)) {
                if (inner === zhWord) return `'${enWord}'`;
            }
            return p;
        }).join("' : '");
    }

    // 3. 尝试整体匹配
    if (dictionary[translated]) {
        translated = dictionary[translated];
    } else {
        // 4. 尝试部分替换
        // 按照词典键长度降序排序，优先匹配长词
        const sortedKeys = Object.keys(dictionary).sort((a, b) => b.length - a.length);
        for (const zhWord of sortedKeys) {
            const enWord = dictionary[zhWord];
            // 转义正则特殊字符
            const escapedZhWord = zhWord.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            const regex = new RegExp(escapedZhWord, 'g');
            translated = translated.replace(regex, enWord);
        }
    }

    // 5. 再次清理
    translated = translated
        .replace(/\s+/g, ' ')
        .trim();

    // 6. 首字母大写（如果首字母是字母且不是单引号开头）
    if (/^[a-z]/.test(translated)) {
        translated = translated.charAt(0).toUpperCase() + translated.slice(1);
    }
    
    en[key] = translated;
}

// 构建新的 en 对象字符串
let enStr = '    en: {\n';
for (const [key, val] of Object.entries(en)) {
    enStr += `    "${key}": "${val.replace(/"/g, '\\"')}",\n`;
}
enStr = enStr.slice(0, -2) + '\n    }';

// 替换原文件中的 en 对象
const newContent = content.replace(/en:\s*\{[\s\S]*?\}/, enStr);
fs.writeFileSync(translationsPath, newContent, 'utf8');

console.log('Successfully translated translations_data.js');
