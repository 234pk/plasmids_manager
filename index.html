<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è´¨ç²’ç®¡ç†ç³»ç»Ÿ - å¢å¼ºç¼–è¾‘ç‰ˆ</title>
    <script src="js/lib/tailwind.min.js"></script>
    <script src="js/lib/vue.global.js"></script>
    <script src="js/lib/compromise.js"></script>
    <script src="js/project-window.js"></script>
    <style>
        [v-cloak] { display: none !important; }
        .init-loader { position: fixed; inset: 0; background: #f9fafb; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
        /* å½“ Vue æŒ‚è½½å®Œæˆï¼ˆv-cloak ç§»é™¤ï¼‰åï¼Œéšè—åŠ è½½å±‚ */
        [v-cloak] ~ .init-loader { display: flex !important; }
        #app:not([v-cloak]) ~ .init-loader { display: none !important; }
        #app:not([v-cloak]) + #init-loader { display: none !important; }
        
        .filter-tag { cursor: pointer; transition: all 0.2s; }
        .filter-tag:hover { opacity: 0.8; }
        .filter-tag.active { background-color: #3b82f6; color: white; }
        .drop-zone { border: 2px dashed #cbd5e1; transition: all 0.3s; }
        .drop-zone.dragging { border-color: #3b82f6; background-color: #eff6ff; }
        .modal-enter-active, .modal-leave-active { transition: opacity 0.3s; }
        .modal-enter-from, .modal-leave-to { opacity: 0; }
        
        /* äº¤äº’ç¾åŒ– */
        .card-hover { transition: transform 0.2s, box-shadow 0.2s; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .btn-scale { transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1); }
        .btn-scale:active { transform: scale(0.95); opacity: 0.9; }
        .btn-scale:hover { filter: brightness(1.1); }
        .toolbar button,
        .toolbar label { height: 2.5rem; font-size: 0.875rem; border-radius: 0.5rem; }
        .table-base { border-collapse: separate; border-spacing: 0; }
        .density-compact th, .density-compact td { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .density-comfortable th, .density-comfortable td { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .badge { display: inline-flex; align-items: center; padding: 0.125rem 0.5rem; border-radius: 0.375rem; font-size: 0.625rem; font-weight: 700; }
        .badge-purple { background: #f3e8ff; color: #6b21a8; }
        .badge-green { background: #dcfce7; color: #166534; }
        .badge-blue { background: #dbeafe; color: #1d4ed8; }
        .badge-amber { background: #fef3c7; color: #92400e; }
        .badge-rose { background: #ffe4e6; color: #be123c; }
        .badge-slate { background: #f1f5f9; color: #475569; }
        
        /* å¼•å¯¼å±‚æ ·å¼ */
        .guide-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); z-index: 1000; }
        .guide-box { position: relative; background: white; padding: 28px; border-radius: 20px; max-width: 400px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); z-index: 1001; }
        .highlight-target { position: relative; z-index: 1002 !important; box-shadow: 0 0 0 4px #3b82f6, 0 0 20px rgba(59, 130, 246, 0.5) !important; background: white !important; }
        
        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ - å¢å¼ºå¯è§æ€§ */
        ::-webkit-scrollbar { width: 16px; height: 16px; }
        ::-webkit-scrollbar-track { background: #e2e8f0; border-radius: 0; }
        ::-webkit-scrollbar-thumb { background: #64748b; border-radius: 8px; border: 3px solid #e2e8f0; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }
        ::-webkit-scrollbar-corner { background: #e2e8f0; }

        /* åˆ—å®½è°ƒæ•´æ‰‹æŸ„ */
        .resizer {
            position: absolute;
            top: 0;
            right: 0;
            width: 5px;
            height: 100vh; /* ä½¿ç”¨ 100vh è®©æ‰‹æŸ„å»¶ä¼¸åˆ°æ•´ä¸ªè¡¨æ ¼é«˜åº¦ï¼Œæ–¹ä¾¿æ‹–æ‹½ */
            max-height: 2000px; /* é˜²æ­¢è¿‡é«˜ */
            cursor: col-resize;
            user-select: none;
            touch-action: none;
            z-index: 10;
            opacity: 0; /* é»˜è®¤éšè— */
        }
        .resizer:hover, .resizing {
            background-color: #3b82f6;
            opacity: 0.5;
            width: 8px; /* æ¿€æ´»æ—¶åŠ å®½ï¼Œæ–¹ä¾¿æŠ“å– */
            right: -4px; /* å±…ä¸­æ˜¾ç¤º */
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="app" v-cloak class="min-w-full mx-auto px-4 sm:px-6 lg:px-8 py-6 relative z-10">
        <!-- ç”¨æˆ·å¼•å¯¼ -->
        <div v-if="showGuide" class="guide-overlay" @click.stop></div>
        <div v-if="showGuide" class="fixed inset-0 z-[1100] flex items-center justify-center pointer-events-none">
            <div class="guide-box pointer-events-auto shadow-2xl border border-blue-100">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800">{{ guideSteps[guideStep].title }}</h3>
                </div>
                <p class="text-gray-600 mb-8 leading-relaxed">{{ guideSteps[guideStep].content }}</p>
                <div class="flex justify-between items-center">
                    <button type="button" @click="skipGuide" class="text-sm font-medium text-gray-400 hover:text-gray-600 transition-colors">ä¸å†æç¤º</button>
                    <div class="flex gap-2">
                        <div v-for="(s, i) in guideSteps" :key="i" :class="['w-2 h-2 rounded-full transition-all', i === guideStep ? 'bg-blue-600 w-4' : 'bg-gray-200']"></div>
                    </div>
                    <button type="button" @click="nextGuide" class="px-6 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-all shadow-lg shadow-blue-200 font-bold btn-scale">
                        {{ guideStep === guideSteps.length - 1 ? 'ç«‹å³å¼€å¯' : 'ä¸‹ä¸€æ­¥' }}
                    </button>
                </div>
            </div>
        </div>

        <!-- æ–°ç”¨æˆ·å¼•å¯¼ç•Œé¢ -->
        <div v-if="!isDatabaseReady" class="max-w-5xl mx-auto mt-20 px-4">
            <div class="bg-white rounded-3xl shadow-2xl p-12 text-center border border-gray-100">
                <div class="mb-12">
                    <h1 class="text-4xl font-extrabold text-slate-800 mb-4 tracking-tight">ğŸ§¬ æ¬¢è¿ä½¿ç”¨è´¨ç²’ç®¡ç†ç³»ç»Ÿ</h1>
                    <p class="text-slate-500 text-lg">çœ‹èµ·æ¥æ‚¨æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œè®©æˆ‘ä»¬å¿«é€Ÿä¸Šæ‰‹ï¼š</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- æ–¹å¼ä¸€ï¼šå¯¼å…¥æ•°æ®åº“ -->
                    <div 
                        @click="linkLocalDatabase"
                        @dragover.prevent="isDragging = true" 
                        @dragleave.prevent="isDragging = false" 
                        @drop.prevent="handleDrop"
                        :class="['group p-8 rounded-2xl border-2 border-dashed cursor-pointer transition-all duration-300 hover:-translate-y-2', isDragging ? 'border-blue-500 bg-blue-50' : 'border-slate-200 hover:border-blue-400 hover:bg-blue-50/50 hover:shadow-xl']"
                    >
                        <div class="w-20 h-20 bg-blue-100 text-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform shadow-sm group-hover:shadow-blue-200">
                            <svg class="w-10 h-10" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" /></svg>
                        </div>
                        <h3 class="text-xl font-bold text-slate-800 mb-3">å¯¼å…¥ç°æœ‰æ•°æ®åº“</h3>
                        <p class="text-sm text-slate-500 mb-6 leading-relaxed">æ‹–å…¥ plasmid_database.json<br>æˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</p>
                        <button class="px-6 py-2.5 bg-white border border-blue-200 text-blue-600 rounded-xl text-sm font-bold group-hover:bg-blue-600 group-hover:text-white transition-all shadow-sm">é€‰æ‹©æ–‡ä»¶</button>
                    </div>

                    <!-- æ–¹å¼äºŒï¼šåˆ›å»ºç¤ºä¾‹æ•°æ®åº“ -->
                    <div 
                        @click="loadSampleDatabase"
                        class="group p-8 rounded-2xl border-2 border-purple-100 bg-gradient-to-b from-purple-50/50 to-white cursor-pointer transition-all duration-300 hover:-translate-y-2 hover:border-purple-300 hover:shadow-xl relative overflow-hidden"
                    >
                        <div class="absolute top-0 right-0 bg-purple-500 text-white text-[10px] px-3 py-1.5 rounded-bl-xl font-bold tracking-wider shadow-sm">æ¨è</div>
                        <div class="w-20 h-20 bg-purple-100 text-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform shadow-sm group-hover:shadow-purple-200">
                            <svg class="w-10 h-10" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" /></svg>
                        </div>
                        <h3 class="text-xl font-bold text-slate-800 mb-3">åˆ›å»ºç¤ºä¾‹æ•°æ®åº“</h3>
                        <p class="text-sm text-slate-500 mb-6 leading-relaxed">ç«‹å³ä½“éªŒå…¨éƒ¨åŠŸèƒ½<br>åŒ…å« 5 ä¸ªç¤ºä¾‹è´¨ç²’</p>
                        <button class="px-6 py-2.5 bg-purple-100 text-purple-700 rounded-xl text-sm font-bold group-hover:bg-purple-600 group-hover:text-white transition-all shadow-sm">åŠ è½½ç¤ºä¾‹</button>
                    </div>

                    <!-- æ–¹å¼ä¸‰ï¼šä»é›¶å¼€å§‹ -->
                    <div 
                        @click="startFromScratch"
                        class="group p-8 rounded-2xl border-2 border-slate-100 cursor-pointer transition-all duration-300 hover:-translate-y-2 hover:border-slate-300 hover:bg-slate-50 hover:shadow-xl"
                    >
                        <div class="w-20 h-20 bg-slate-100 text-slate-600 rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform shadow-sm group-hover:shadow-slate-200">
                            <svg class="w-10 h-10" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                        </div>
                        <h3 class="text-xl font-bold text-slate-800 mb-3">ä»é›¶å¼€å§‹</h3>
                        <p class="text-sm text-slate-500 mb-6 leading-relaxed">æ‰‹åŠ¨åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªè´¨ç²’<br>å»ºç«‹å…¨æ–°çš„æ•°æ®åº“</p>
                        <button class="px-6 py-2.5 bg-white border border-slate-300 text-slate-600 rounded-xl text-sm font-bold group-hover:bg-slate-800 group-hover:text-white transition-all shadow-sm">åˆ›å»ºç©ºç™½åº“</button>
                    </div>
                </div>

                <!-- éšè—çš„æ–‡ä»¶è¾“å…¥æ¡† -->
                <input 
                    type="file" 
                    id="db-file-input" 
                    class="hidden" 
                    accept=".json" 
                    @change="handleFileSelect"
                >
            </div>
        </div>

        <!-- ä¸»ç•Œé¢ -->
        <div v-else>
            <header class="mb-8 flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold text-gray-800">è´¨ç²’ç®¡ç†ç³»ç»Ÿ</h1>
                    <p class="text-gray-600 mt-2">
                        å…±æœ‰ {{ plasmids.length }} æ¡è®°å½• | <span class="text-blue-600 font-medium">å½“å‰ç­›é€‰å‡º {{ filteredPlasmids.length }} æ¡</span>
                    </p>
                </div>
                <div class="flex flex-col sm:flex-row gap-4 items-center justify-between toolbar bg-white p-3 rounded-xl border border-gray-100 shadow-sm">
                    <!-- å·¦ä¾§ï¼šæ ¸å¿ƒæ“ä½œ -->
                    <div class="flex items-center gap-3">
                        <div class="relative">
                            <button type="button" @click="createNewPlasmid" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-md shadow-blue-200 flex items-center gap-2 transition-all btn-scale font-bold">
                                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                                æ–°å»ºè´¨ç²’
                            </button>
                        </div>
                        <div class="relative">
                            <button type="button" id="btn-batch-import" @click="triggerBatchImport" class="px-4 py-2 bg-white border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 hover:border-gray-300 shadow-sm flex items-center gap-2 transition-all btn-scale font-medium">
                                <svg class="w-5 h-5 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
                                æ‰¹é‡å¯¼å…¥
                            </button>
                        </div>
                        <div v-if="isElectron" class="relative">
                            <button type="button" @click="scanAndImportLocal" class="px-4 py-2 bg-white border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 hover:border-gray-300 shadow-sm flex items-center gap-2 transition-all btn-scale font-medium">
                                <svg class="w-5 h-5 text-amber-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                                æ‰«æç›®å½•
                            </button>
                        </div>
                    </div>

                    <!-- å³ä¾§ï¼šå·¥å…·ä¸ç³»ç»Ÿ -->
                    <div class="flex items-center gap-3">
                        <!-- è§†å›¾è®¾ç½® -->
                        <div class="relative group">
                            <button type="button" class="p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all" title="æ˜¾ç¤ºè®¾ç½®">
                                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" /></svg>
                            </button>
                            <div class="absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-20 p-3">
                                <div class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 px-1">åˆ—æ˜¾ç¤º</div>
                                <label v-for="(visible, col) in settings.displayConfig.columnVisibility" :key="col" class="flex items-center gap-3 px-2 py-1.5 hover:bg-gray-50 rounded-md cursor-pointer transition-colors">
                                    <input type="checkbox" v-model="settings.displayConfig.columnVisibility[col]" class="w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                                    <span class="text-sm text-gray-700">{{ col }}</span>
                                </label>
                                
                                <template v-if="isElectron">
                                    <div class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 px-1 mt-3 pt-2 border-t border-gray-100">ç•Œé¢ç¼©æ”¾</div>
                                    <div class="flex items-center justify-between px-2 mb-1 bg-gray-50 rounded-lg p-1">
                                        <button type="button" @click="setZoom((settings.zoomLevel || 0) - 0.1)" class="w-8 h-6 flex items-center justify-center text-gray-500 hover:text-blue-600 hover:bg-white rounded shadow-sm transition-all text-lg leading-none pb-1">-</button>
                                        <span class="text-xs text-gray-700 font-bold min-w-[3rem] text-center">{{ Math.round(((settings.zoomLevel || 0) + 1) * 100) }}%</span>
                                        <button type="button" @click="setZoom((settings.zoomLevel || 0) + 0.1)" class="w-8 h-6 flex items-center justify-center text-gray-500 hover:text-blue-600 hover:bg-white rounded shadow-sm transition-all text-lg leading-none pb-1">+</button>
                                    </div>
                                    <button type="button" @click="setZoom(0)" class="w-full text-[10px] text-center text-gray-400 hover:text-blue-600 py-1 transition-colors">é‡ç½®é»˜è®¤å¤§å°</button>
                                </template>
                            </div>
                        </div>

                        <!-- æ•°æ®å·¥å…· -->
                        <div class="h-6 w-px bg-gray-200 mx-1"></div>
                        
                        <div class="flex items-center bg-gray-50 rounded-lg p-1 border border-gray-200">
                            <button type="button" @click="showExportModal = true" class="px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-blue-600 hover:bg-white rounded-md transition-all flex items-center gap-1">
                                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2m3.293-7.707a1 1 0 011.414 0L9 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" /></svg>
                                å¯¼å‡º
                            </button>
                            <label class="px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-blue-600 hover:bg-white rounded-md transition-all flex items-center gap-1 cursor-pointer">
                                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" /></svg>
                                å¯¼å…¥
                                <input type="file" accept=".csv" class="hidden" @change="handleCSVImport">
                            </label>
                        </div>

                        <div class="h-6 w-px bg-gray-200 mx-1"></div>

                        <!-- ç³»ç»Ÿæ“ä½œ -->
                        <button type="button" id="btn-save-db" @click="saveDatabaseFile" class="p-2 text-emerald-600 bg-emerald-50 hover:bg-emerald-100 rounded-lg transition-all" :title="dbFileHandle ? 'ç›´æ¥ä¿å­˜æ‰€æœ‰æ•°æ®' : 'ä¿å­˜å½“å‰æ‰€æœ‰ä¿¡æ¯'">
                            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" /></svg>
                        </button>
                        <button type="button" @click="showSettingsModal = true" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-all" title="è®¾ç½®">
                            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                        </button>
                        
                        <!-- æ›´å¤šèœå• (Log, DB Ops) -->
                        <div class="relative group">
                            <button type="button" class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all">
                                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" /></svg>
                            </button>
                            <div class="absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-20 overflow-hidden">
                                <button type="button" @click="showLogModal = true" class="w-full text-left px-4 py-3 hover:bg-gray-50 text-sm text-gray-700 flex items-center gap-2">
                                    <svg class="w-4 h-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
                                    ç³»ç»Ÿæ—¥å¿—
                                </button>
                                <div class="h-px bg-gray-100 my-0"></div>
                                <button type="button" @click="createNewDatabase" class="w-full text-left px-4 py-3 hover:bg-gray-50 text-sm text-gray-700 flex items-center gap-2">
                                    <svg class="w-4 h-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
                                    æ–°å»ºæ•°æ®åº“
                                </button>
                                <button type="button" @click="switchDatabase" class="w-full text-left px-4 py-3 hover:bg-gray-50 text-sm text-gray-700 flex items-center gap-2">
                                    <svg class="w-4 h-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" /></svg>
                                    åˆ‡æ¢æ•°æ®åº“
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- è§†å›¾åˆ‡æ¢æ ‡ç­¾é¡µ -->
            <div class="flex border-b border-gray-200 mb-6">
                <button type="button"
                    @click="currentView = 'library'"
                    :class="['px-6 py-3 font-bold text-sm transition-colors border-b-2', currentView === 'library' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700']"
                >
                    è´¨ç²’åº“
                </button>
                <button type="button"
                    @click="currentView = 'projects'"
                    :class="['px-6 py-3 font-bold text-sm transition-colors border-b-2', currentView === 'projects' ? 'border-purple-500 text-purple-600' : 'border-transparent text-gray-500 hover:text-gray-700']"
                >
                    é¡¹ç›®ç®¡ç†
                </button>
                <button type="button"
                    @click="currentView = 'holders'"
                    :class="['px-6 py-3 font-bold text-sm transition-colors border-b-2', currentView === 'holders' ? 'border-amber-500 text-amber-600' : 'border-transparent text-gray-500 hover:text-gray-700']"
                >
                    æŒæœ‰äººç®¡ç†
                </button>
            </div>

            <!-- è´¨ç²’ç®¡ç†ä¸»è§†å›¾ (æ”¯æŒ è´¨ç²’åº“ã€é¡¹ç›®ã€æŒæœ‰äºº) -->
            <div v-show="['library', 'projects', 'holders'].includes(currentView)">
            <div class="flex flex-col lg:flex-row gap-6 items-start">
                    <!-- å·¦ä¾§è¾¹æ : ä»…åœ¨é¡¹ç›®å’ŒæŒæœ‰äººè§†å›¾æ˜¾ç¤º -->
                    <aside v-if="currentView === 'projects'" class="w-full lg:w-72 flex-shrink-0 space-y-4" aria-label="é¡¹ç›®åˆ—è¡¨">
                        <div class="bg-white rounded-xl shadow-md border border-gray-100 overflow-hidden">
                            <div class="p-4 bg-purple-50 border-b border-purple-100 flex justify-between items-center">
                                <h3 class="font-bold text-purple-700 text-sm flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg>
                                    é¡¹ç›®åˆ—è¡¨
                                </h3>
                                <button type="button" @click="openCreateProject" class="p-1 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors" aria-label="æ–°å»ºé¡¹ç›®">
                                    <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
                                </button>
                            </div>
                            <div class="p-2 max-h-[60vh] overflow-y-auto">
                                <div v-for="proj in projects" :key="proj.id" 
                                     @click="selectedProjectId = proj.id"
                                     :class="['p-3 rounded-lg cursor-pointer mb-1 transition-all flex justify-between items-center group', selectedProjectId === proj.id ? 'bg-purple-600 text-white shadow-md' : 'hover:bg-purple-50 text-gray-700']">
                                    <div class="min-w-0 flex-1">
                                        <div class="font-bold text-sm truncate">{{ proj.name }}</div>
                                        <div :class="['text-[10px]', selectedProjectId === proj.id ? 'text-purple-100' : 'text-gray-400']">{{ (proj.plasmidIds || []).length }} ä¸ªè´¨ç²’</div>
                                    </div>
                                    <div class="flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                        <button type="button" @click.stop="openEditProject(proj)" class="p-1 hover:bg-white/20 rounded" aria-label="ç¼–è¾‘é¡¹ç›®"><svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg></button>
                                        <button type="button" @click.stop="removeProject(proj)" class="p-1 hover:bg-red-500 hover:text-white rounded text-red-500 transition-colors" aria-label="åˆ é™¤é¡¹ç›®"><svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-4v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg></button>
                                    </div>
                                </div>
                                <div v-if="projects.length === 0" class="text-center py-8 text-gray-400 text-xs italic">æš‚æ— é¡¹ç›®</div>
                            </div>
                        </div>
                    </aside>

                    <aside v-if="currentView === 'holders'" class="w-full lg:w-72 flex-shrink-0 space-y-4" aria-label="æŒæœ‰äººåˆ—è¡¨">
                        <div class="bg-white rounded-xl shadow-md border border-gray-100 overflow-hidden">
                            <div class="p-4 bg-amber-50 border-b border-amber-100 flex justify-between items-center">
                                <h3 class="font-bold text-amber-700 text-sm flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                                    æŒæœ‰äººåˆ—è¡¨
                                </h3>
                                <button type="button" @click="createHolder" class="p-1 bg-amber-500 text-white rounded hover:bg-amber-600 transition-colors" aria-label="æ–°å»ºæŒæœ‰äºº">
                                    <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
                                </button>
                            </div>
                            <div class="p-2 max-h-[60vh] overflow-y-auto">
                                <div v-for="holder in uniqueHolders" :key="holder" 
                                     @click="selectedHolder = holder"
                                     :class="['p-3 rounded-lg cursor-pointer mb-1 transition-all flex justify-between items-center group', selectedHolder === holder ? 'bg-amber-500 text-white shadow-md' : 'hover:bg-amber-50 text-gray-700']">
                                    <div class="flex items-center gap-3 min-w-0">
                                        <div :class="['w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs flex-shrink-0', selectedHolder === holder ? 'bg-white/20' : 'bg-amber-100 text-amber-600']">
                                            {{ holder.charAt(0).toUpperCase() }}
                                        </div>
                                        <div class="font-bold text-sm truncate">{{ holder }}</div>
            </div>
            <div class="flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity ml-2">
                <button type="button" @click.stop="deleteHolder(holder)" class="p-1 hover:bg-red-500 hover:text-white rounded text-red-500 transition-colors" aria-label="åˆ é™¤æŒæœ‰äºº"><svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-4v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg></button>
            </div>
        </div>
                                <div v-if="uniqueHolders.length === 0" class="text-center py-8 text-gray-400 text-xs italic">æš‚æ— æŒæœ‰äººæ•°æ®</div>
                            </div>
                        </div>
                    </aside>

                    <!-- å³ä¾§/ä¸»å†…å®¹åŒº -->
                    <div class="flex-1">
                        <!-- é¡¶éƒ¨æœç´¢å’Œå…¨å±€è®¾ç½® -->
                        <div id="section-search" class="bg-white rounded-xl shadow-md p-6 mb-6 border border-gray-100">
                            <div class="flex flex-col md:flex-row gap-6 mb-6">
                                <div class="flex-1 relative">
                                    <label class="block text-sm font-bold text-gray-700 mb-2 flex items-center justify-between gap-2">
                                        <span class="flex items-center gap-2">
                                            <svg class="w-4 h-4 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                                            {{ currentView === 'library' ? 'æ·±åº¦å…¨å±€æœç´¢' : (currentView === 'projects' ? 'åœ¨å½“å‰é¡¹ç›®ä¸­æœç´¢' : 'æœç´¢æŒæœ‰äººçš„è´¨ç²’') }}
                                        </span>
                                        <div v-if="currentView === 'projects' && selectedProjectId" class="ml-auto flex items-center gap-2">
                                            <button type="button" @click="clearProjectPlasmids(selectedProjectId)" class="text-xs text-red-500 hover:text-red-700 hover:underline px-2 py-1 bg-red-50 rounded border border-red-100 transition-colors" title="ä»…ç§»é™¤å…³è”ï¼Œä¸åˆ é™¤è´¨ç²’">
                                                æ¸…ç©ºé¡¹ç›®å…³è”
                                            </button>
                                        </div>
                                        <div v-if="currentView === 'holders' && selectedHolder" class="ml-auto flex items-center gap-2">
                                            <button type="button" @click="clearHolderPlasmids(selectedHolder)" class="text-xs text-red-500 hover:text-red-700 hover:underline px-2 py-1 bg-red-50 rounded border border-red-100 transition-colors" title="ä»…æ¸…ç©ºå­—æ®µï¼Œä¸åˆ é™¤è´¨ç²’">
                                                æ¸…ç©ºæŒæœ‰äººå…³è”
                                            </button>
                                        </div>
                                        <button type="button" v-if="searchQuery" @click="searchQuery = ''" class="text-gray-400 hover:text-gray-600 transition-colors" aria-label="æ¸…ç©ºæœç´¢">
                                            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                                        </button>
                                    </label>
                                    <input v-model="searchQuery" type="text" placeholder="è¾“å…¥ä»»ä½•å…³é”®è¯..." class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all shadow-sm">
                                </div>
                                <div class="w-48">
                                    <label class="block text-sm font-bold text-gray-700 mb-2">æ¯é¡µæ˜¾ç¤ºæ¡æ•°</label>
                                    <select v-model="pageSize" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all shadow-sm">
                                        <option :value="10">10 æ¡</option>
                                        <option :value="20">20 æ¡</option>
                                        <option :value="50">50 æ¡</option>
                                        <option :value="100">100 æ¡</option>
                                        <option :value="-1">å…¨éƒ¨æ˜¾ç¤º</option>
                                    </select>
                                </div>
                                <div class="w-48">
                                    <label class="block text-sm font-bold text-gray-700 mb-2">è¡¨æ ¼å¯†åº¦</label>
                                    <div class="flex bg-gray-100 p-1 rounded-lg">
                                        <button type="button" @click="settings.displayConfig.tableDensity = 'compact'" :class="['flex-1 px-3 py-2 text-xs font-bold rounded-md transition-all', settings.displayConfig.tableDensity === 'compact' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-500 hover:text-gray-700']">ç´§å‡‘</button>
                                        <button type="button" @click="settings.displayConfig.tableDensity = 'comfortable'" :class="['flex-1 px-3 py-2 text-xs font-bold rounded-md transition-all', settings.displayConfig.tableDensity !== 'compact' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-500 hover:text-gray-700']">èˆ’é€‚</button>
                                    </div>
                                </div>
                                <div class="w-48">
                                    <label class="block text-sm font-bold text-gray-700 mb-2">æ’åºæ–¹å¼</label>
                                    <select v-model="sortConfig.key" @change="sortConfig.order = 'desc'" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all shadow-sm">
                                        <option value="æ·»åŠ æ—¶é—´">æ·»åŠ æ—¶é—´</option>
                                        <option value="æ›´æ–°æ—¶é—´">æ›´æ–°æ—¶é—´</option>
                                        <option value="æ–‡ä»¶å">åç§°</option>
                                    </select>
                                </div>
                                <div class="w-24">
                                    <label class="block text-sm font-bold text-gray-700 mb-2">é¡ºåº</label>
                                    <button type="button" @click="sortConfig.order = sortConfig.order === 'asc' ? 'desc' : 'asc'" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all shadow-sm bg-white text-gray-700 font-bold flex items-center justify-center gap-2">
                                        {{ sortConfig.order === 'asc' ? 'å‡åº' : 'é™åº' }}
                                        <svg v-if="sortConfig.order === 'asc'" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12" /></svg>
                                        <svg v-else class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h13M3 8h9m-9 4h5m4 0v12m0 0l-4-4m4 4l4-4" /></svg>
                                    </button>
                                </div>
                            </div>

                            <!-- ä»…åœ¨è´¨ç²’åº“è§†å›¾æ˜¾ç¤ºé«˜çº§ç­›é€‰ -->
                            <template v-if="currentView === 'library'">
                                <div class="flex items-center justify-between pt-4 border-t border-gray-50 mb-4">
                                    <div class="flex items-center gap-4">
                                        <span class="text-xs font-bold text-gray-500 uppercase tracking-wider">ç­›é€‰æ¨¡å¼:</span>
                                        <div class="flex bg-gray-100 p-1 rounded-lg">
                                            <button type="button" @click="filterLogic = 'AND'" :class="['px-3 py-1 text-[10px] font-bold rounded-md transition-all', filterLogic === 'AND' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-500 hover:text-gray-700']">äº¤é›† (AND)</button>
                                            <button type="button" @click="filterLogic = 'OR'" :class="['px-3 py-1 text-[10px] font-bold rounded-md transition-all', filterLogic === 'OR' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-500 hover:text-gray-700']">å¹¶é›† (OR)</button>
                                        </div>
                                    </div>
                                    <button type="button" v-if="hasActiveFilters" @click="clearAllFilters" class="text-[10px] font-bold text-red-500 hover:text-red-700 flex items-center gap-1 transition-colors">
                                        <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-4v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                                        æ¸…é™¤æ‰€æœ‰ç­›é€‰
                                    </button>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-8 gap-4">
                                    <div v-for="(options, key) in filterOptions" :key="key" class="min-w-0">
                                        <label class="block text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2 truncate">{{ key }}</label>
                                        <div class="flex flex-wrap gap-1 max-h-24 overflow-y-auto pr-1 scrollbar-thin">
                                            <span v-for="option in options" :key="option" @click="toggleFilter(key, option)"
                                                :class="['px-1.5 py-0.5 text-[10px] rounded border cursor-pointer transition-all whitespace-nowrap', isFilterActive(key, option) ? 'active bg-blue-600 text-white border-blue-600 shadow-sm' : 'bg-white text-gray-500 border-gray-100 hover:border-blue-200']">
                                                {{ option }}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </template>

                            <!-- åœ¨é¡¹ç›®/æŒæœ‰äººè§†å›¾æ˜¾ç¤ºå½“å‰é€‰ä¸­çš„æç¤º -->
                            <div v-else class="flex items-center gap-3 pt-4 border-t border-gray-50">
                                <span class="text-xs font-bold text-gray-500 uppercase tracking-wider">å½“å‰ç­›é€‰:</span>
                                <div v-if="currentView === 'projects' && selectedProjectId" class="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-bold flex items-center gap-2">
                                    é¡¹ç›®: {{ getProjectNameById(selectedProjectId) }}
                                    <button type="button" @click="selectedProjectId = null" class="hover:text-purple-900">Ã—</button>
                                </div>
                                <div v-else-if="currentView === 'holders' && selectedHolder" class="px-3 py-1 bg-amber-100 text-amber-700 rounded-full text-xs font-bold flex items-center gap-2">
                                    æŒæœ‰äºº: {{ selectedHolder }}
                                    <button type="button" @click="selectedHolder = null" class="hover:text-amber-900">Ã—</button>
                                </div>
                                <div v-else class="text-xs text-gray-400 italic">è¯·ä»å·¦ä¾§é€‰æ‹©ä¸€ä¸ª{{ currentView === 'projects' ? 'é¡¹ç›®' : 'æŒæœ‰äºº' }}è¿›è¡ŒæŸ¥çœ‹</div>
                            </div>
                        </div>

                        <!-- æ•°æ®è¡¨æ ¼ -->
                        <div class="bg-white rounded-xl shadow-lg border border-gray-100 min-w-full w-fit">
                <div class="pb-3" :class="tableDensityClass">
                    <div class="">
                    <table class="min-w-full w-max divide-y divide-slate-200 table-base">
                        <thead class="bg-slate-50 text-[11px] text-slate-500 uppercase font-bold tracking-wider">
                            <tr>
                                <th class="px-6 py-4 text-center w-12 whitespace-nowrap relative group">
                                    <input type="checkbox" :checked="filteredPlasmids.length > 0 && selectedPlasmids.size === filteredPlasmids.length" @change="selectAll" class="w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                                </th>
                                <th v-if="settings.displayConfig.columnVisibility['è´¨ç²’ä¿¡æ¯']" class="px-6 py-4 text-left whitespace-nowrap relative group" :style="getColumnWidth('è´¨ç²’ä¿¡æ¯')">
                                    è´¨ç²’ä¿¡æ¯
                                    <div class="resizer" @mousedown.stop.prevent="initResize($event)"></div>
                                </th>
                                <th v-if="settings.displayConfig.columnVisibility['ç‰¹å¾ä¸åˆ†ç±»']" class="px-6 py-4 text-left whitespace-nowrap relative group" :style="getColumnWidth('ç‰¹å¾ä¸åˆ†ç±»')">
                                    ç‰¹å¾ä¸åˆ†ç±»
                                    <div class="resizer" @mousedown.stop.prevent="initResize($event)"></div>
                                </th>
                                <th v-if="settings.displayConfig.columnVisibility['æŠ—æ€§']" class="px-6 py-4 text-left whitespace-nowrap relative group" :style="getColumnWidth('æŠ—æ€§ & è¯±å¯¼')">
                                    æŠ—æ€§ &amp; è¯±å¯¼
                                    <div class="resizer" @mousedown.stop.prevent="initResize($event)"></div>
                                </th>
                                <th v-if="settings.displayConfig.columnVisibility['ä¸“ä¸šç‰¹å¾']" class="px-6 py-4 text-left whitespace-nowrap relative group" :style="getColumnWidth('ä¸“ä¸šç‰¹å¾')">
                                    ä¸“ä¸šç‰¹å¾
                                    <div class="resizer" @mousedown.stop.prevent="initResize($event)"></div>
                                </th>
                                <th v-if="settings.displayConfig.columnVisibility['ä¿å­˜ä½ç½®'] || settings.displayConfig.columnVisibility['æŒæœ‰äºº'] || settings.displayConfig.columnVisibility['é¡¹ç›®']" class="px-6 py-4 text-left whitespace-nowrap relative group" :style="getColumnWidth('å­˜å‚¨ä¿¡æ¯')">
                                    å­˜å‚¨ä¿¡æ¯
                                    <div class="resizer" @mousedown.stop.prevent="initResize($event)"></div>
                                </th>
                                <th v-if="settings.displayConfig.columnVisibility['æ—¶é—´ä¿¡æ¯']" class="px-6 py-4 text-left whitespace-nowrap relative group" :style="getColumnWidth('æ—¶é—´ä¿¡æ¯')">
                                    æ—¶é—´ä¿¡æ¯
                                    <div class="resizer" @mousedown.stop.prevent="initResize($event)"></div>
                                </th>
                                <th v-if="settings.displayConfig.columnVisibility['åºåˆ—ä¿¡æ¯']" class="px-6 py-4 text-left whitespace-nowrap relative group" :style="getColumnWidth('åºåˆ—ä¿¡æ¯')">
                                    åºåˆ—ä¿¡æ¯
                                    <div class="resizer" @mousedown.stop.prevent="initResize($event)"></div>
                                </th>
                                <th v-if="settings.displayConfig.columnVisibility['æè¿°']" class="px-6 py-4 text-left whitespace-nowrap relative group" :style="getColumnWidth('æè¿°')">
                                    æè¿°
                                    <div class="resizer" @mousedown.stop.prevent="initResize($event)"></div>
                                </th>
                                <th class="px-4 py-4 text-center w-28 whitespace-nowrap">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="main-table-body" class="divide-y divide-gray-100">
                            <tr v-for="(p, index) in paginatedPlasmids" :key="p.æ–‡ä»¶å" class="hover:bg-blue-50/30 transition-colors group">
                                <td class="px-6 py-5 text-center">
                                    <input type="checkbox" :checked="selectedPlasmids.has(p.id)" @click="toggleSelection(p, $event)" class="w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                                </td>
                                <td v-if="settings.displayConfig.columnVisibility['è´¨ç²’ä¿¡æ¯']" class="px-6 py-5">
                                    <div class="text-sm font-bold text-gray-900 group-hover:text-blue-600 transition-colors">{{ p.æ–‡ä»¶å }}</div>
                                    <div class="mt-1.5">
                                        <a href="#" @click.prevent="openFolder(p.è·¯å¾„)" class="text-[11px] text-gray-400 hover:text-blue-600 hover:underline truncate max-w-[220px] block transition-colors" :title="'æ‰“å¼€æ‰€åœ¨æ–‡ä»¶å¤¹: ' + p.è·¯å¾„">
                                            {{ p.è·¯å¾„ }}
                                        </a>
                                    </div>
                                </td>
                                <td v-if="settings.displayConfig.columnVisibility['ç‰¹å¾ä¸åˆ†ç±»']" class="px-6 py-5">
                                    <div class="flex flex-wrap gap-1.5 mb-2">
                                        <template v-if="Array.isArray(p.è½½ä½“ç±»å‹)">
                                            <span v-for="tag in p.è½½ä½“ç±»å‹" :key="tag" class="badge badge-purple">{{ tag }}</span>
                                        </template>
                                        <span v-else-if="p.è½½ä½“ç±»å‹" class="badge badge-purple">{{ p.è½½ä½“ç±»å‹ }}</span>
                                        <template v-if="Array.isArray(p.ç‰©ç§)">
                                            <span v-for="tag in p.ç‰©ç§" :key="tag" class="badge badge-green">{{ tag }}</span>
                                        </template>
                                        <span v-else-if="p.ç‰©ç§" class="badge badge-green">{{ p.ç‰©ç§ }}</span>
                                    </div>
                                    <div class="text-xs flex flex-wrap items-center gap-1.5">
                                        <span class="font-bold text-gray-700">é¶åŸºå› :</span>
                                        <span class="text-gray-900 font-medium">{{ Array.isArray(p.é¶åŸºå› ) ? p.é¶åŸºå› .join(',') : p.é¶åŸºå›  }}</span>
                                        <div v-if="p.é¶åŸºå›  && p.é¶åŸºå›  !== 'æ— ' && p.é¶åŸºå› .length" class="flex gap-1">
                                            <template v-for="link in getBioLinks(p.é¶åŸºå› , p.ç‰©ç§)" :key="link.name">
                                                <div class="flex items-center gap-0.5 group">
                                                    <a href="#" @click.prevent="openExternalLink(link.uniprot)" class="w-4 h-4 flex items-center justify-center bg-blue-50 text-blue-600 text-[9px] font-black rounded hover:bg-blue-600 hover:text-white transition-all border border-blue-100" title="UniProt: è›‹ç™½è´¨ä¿¡æ¯">U</a>
                                                    <a href="#" @click.prevent="openExternalLink(link.ncbi)" class="w-4 h-4 flex items-center justify-center bg-green-50 text-green-600 text-[9px] font-black rounded hover:bg-green-600 hover:text-white transition-all border border-green-100" title="NCBI: åŸºå› /æ ¸è‹·é…¸ä¿¡æ¯">N</a>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                    <div class="text-[10px] text-gray-500 mt-0.5">
                                        <span class="font-medium text-gray-400">åŠŸèƒ½:</span> {{ Array.isArray(p.åŠŸèƒ½) ? p.åŠŸèƒ½.join(',') : p.åŠŸèƒ½ }}
                                    </div>
                                </td>
                                <td v-if="settings.displayConfig.columnVisibility['æŠ—æ€§']" class="px-6 py-5 text-xs">
                                    <div class="flex flex-col gap-1">
                                        <div v-if="p.å¤§è‚ æ†èŒæŠ—æ€§ && p.å¤§è‚ æ†èŒæŠ—æ€§.length" class="flex items-center gap-1">
                                            <span class="w-1.5 h-1.5 rounded-full bg-orange-400"></span>
                                            <span class="text-gray-600">E.coli: {{ Array.isArray(p.å¤§è‚ æ†èŒæŠ—æ€§) ? p.å¤§è‚ æ†èŒæŠ—æ€§.join(',') : p.å¤§è‚ æ†èŒæŠ—æ€§ }}</span>
                                        </div>
                                        <div v-if="p.å“ºä¹³åŠ¨ç‰©æŠ—æ€§ && p.å“ºä¹³åŠ¨ç‰©æŠ—æ€§.length" class="flex items-center gap-1">
                                            <span class="w-1.5 h-1.5 rounded-full bg-blue-400"></span>
                                            <span class="text-gray-600">Mammal: {{ Array.isArray(p.å“ºä¹³åŠ¨ç‰©æŠ—æ€§) ? p.å“ºä¹³åŠ¨ç‰©æŠ—æ€§.join(',') : p.å“ºä¹³åŠ¨ç‰©æŠ—æ€§ }}</span>
                                        </div>
                                        <div v-if="p.å››ç¯ç´ è¯±å¯¼ && p.å››ç¯ç´ è¯±å¯¼.length" class="flex items-center gap-1">
                                            <span class="w-1.5 h-1.5 rounded-full bg-red-400"></span>
                                            <span class="text-gray-600">Tet: {{ Array.isArray(p.å››ç¯ç´ è¯±å¯¼) ? p.å››ç¯ç´ è¯±å¯¼.join(',') : p.å››ç¯ç´ è¯±å¯¼ }}</span>
                                        </div>
                                    </div>
                                </td>
                                <td v-if="settings.displayConfig.columnVisibility['ä¸“ä¸šç‰¹å¾']" class="px-6 py-5 text-[11px]">
                                    <div class="space-y-1">
                                        <div v-if="p.æ’å…¥ç±»å‹ && p.æ’å…¥ç±»å‹.length"><span class="font-bold text-gray-500">æ’å…¥:</span> {{ Array.isArray(p.æ’å…¥ç±»å‹) ? p.æ’å…¥ç±»å‹.join(',') : p.æ’å…¥ç±»å‹ }}</div>
                                        <div v-if="p.è›‹ç™½æ ‡ç­¾ && p.è›‹ç™½æ ‡ç­¾.length"><span class="font-bold text-gray-500">æ ‡ç­¾:</span> {{ Array.isArray(p.è›‹ç™½æ ‡ç­¾) ? p.è›‹ç™½æ ‡ç­¾.join(',') : p.è›‹ç™½æ ‡ç­¾ }}</div>
                                        <div v-if="p.è§å…‰è›‹ç™½ && p.è§å…‰è›‹ç™½.length"><span class="font-bold text-gray-500">è§å…‰:</span> {{ Array.isArray(p.è§å…‰è›‹ç™½) ? p.è§å…‰è›‹ç™½.join(',') : p.è§å…‰è›‹ç™½ }}</div>
                                        <div v-if="p.å¯åŠ¨å­ && p.å¯åŠ¨å­.length"><span class="font-bold text-gray-500">å¯åŠ¨å­:</span> {{ Array.isArray(p.å¯åŠ¨å­) ? p.å¯åŠ¨å­.join(',') : p.å¯åŠ¨å­ }}</div>
                                        <div v-if="p.çªå˜ && p.çªå˜.length"><span class="font-bold text-red-500">çªå˜:</span> {{ Array.isArray(p.çªå˜) ? p.çªå˜.join(',') : p.çªå˜ }}</div>
                                    </div>
                                </td>
                                <td v-if="settings.displayConfig.columnVisibility['ä¿å­˜ä½ç½®'] || settings.displayConfig.columnVisibility['æŒæœ‰äºº'] || settings.displayConfig.columnVisibility['é¡¹ç›®']" class="px-6 py-5">
                                    <div class="flex flex-col gap-2">
                                        <div v-if="settings.displayConfig.columnVisibility['ä¿å­˜ä½ç½®']" class="flex items-center gap-2">
                                            <span class="text-[10px] font-bold text-gray-400 w-8">ä½ç½®</span>
                                            <div class="text-xs text-gray-700 font-mono bg-gray-50 px-2 py-1 rounded border border-gray-100 inline-block cursor-pointer hover:bg-gray-100 hover:text-blue-600 hover:border-blue-200 transition-all" 
                                                 @click="handleQuickFilter('location', p.ä¿å­˜ä½ç½®)" 
                                                 title="ç‚¹å‡»ç­›é€‰æ­¤ä½ç½®">
                                                {{ p.ä¿å­˜ä½ç½® || '-' }}
                                            </div>
                                        </div>
                                        <div v-if="settings.displayConfig.columnVisibility['æŒæœ‰äºº']" class="flex items-center gap-2">
                                            <span class="text-[10px] font-bold text-gray-400 w-8">æŒæœ‰</span>
                                            <div class="flex items-center gap-1.5 cursor-pointer hover:opacity-80 transition-all" 
                                                 @click="handleQuickFilter('holder', p.æŒæœ‰äºº)"
                                                 title="ç‚¹å‡»æŸ¥çœ‹æ­¤æŒæœ‰äººçš„æ‰€æœ‰è´¨ç²’">
                                                <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-[10px] font-bold">
                                                    {{ (p.æŒæœ‰äºº || 'æ— ').charAt(0).toUpperCase() }}
                                                </div>
                                                <span class="text-xs text-gray-700 hover:text-blue-600 hover:underline">{{ p.æŒæœ‰äºº || '-' }}</span>
                                            </div>
                                        </div>
                                        <div v-if="settings.displayConfig.columnVisibility['é¡¹ç›®']" class="flex items-center gap-2">
                                            <span class="text-[10px] font-bold text-gray-400 w-8">é¡¹ç›®</span>
                                            <div class="text-xs text-gray-700 font-medium">
                                                <template v-if="p.é¡¹ç›® && p.é¡¹ç›®.length">
                                                    <span v-for="(pid, idx) in p.é¡¹ç›®" :key="pid" 
                                                          class="cursor-pointer hover:text-blue-600 hover:underline"
                                                          @click="handleQuickFilter('project', pid)">
                                                        {{ getProjectNameById(pid) }}{{ idx < p.é¡¹ç›®.length - 1 ? ', ' : '' }}
                                                    </span>
                                                </template>
                                                <span v-else>-</span>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td v-if="settings.displayConfig.columnVisibility['æ—¶é—´ä¿¡æ¯']" class="px-6 py-5 text-[11px] text-gray-500 font-mono">
                                    <div class="flex flex-col gap-1">
                                        <div v-if="p.æ·»åŠ æ—¶é—´" title="æ·»åŠ æ—¶é—´">
                                            <span class="text-[10px] font-bold text-gray-400 mr-1">æ·»åŠ :</span>
                                            {{ new Date(p.æ·»åŠ æ—¶é—´).toLocaleString() }}
                                        </div>
                                        <div v-if="p.æ›´æ–°æ—¶é—´" title="æ›´æ–°æ—¶é—´">
                                            <span class="text-[10px] font-bold text-gray-400 mr-1">æ›´æ–°:</span>
                                            {{ new Date(p.æ›´æ–°æ—¶é—´).toLocaleString() }}
                                        </div>
                                    </div>
                                </td>
                                <td v-if="settings.displayConfig.columnVisibility['åºåˆ—ä¿¡æ¯']" class="px-6 py-5 text-xs">
                                    <div v-if="p.åºåˆ—" class="flex flex-col gap-1">
                                        <div class="flex items-center gap-1.5 text-emerald-600 font-bold">
                                            <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
                                            å·²å½•å…¥
                                        </div>
                                        <div class="text-[10px] text-gray-400 font-mono">{{ p.åºåˆ—.length }} bp</div>
                                    </div>
                                    <div v-else class="text-gray-300 italic flex items-center gap-1">
                                        <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>
                                        æš‚æ— åºåˆ—
                                    </div>
                                </td>
                                <td v-if="settings.displayConfig.columnVisibility['æè¿°']" class="px-6 py-5">
                                    <div class="text-xs text-gray-500 max-w-xs line-clamp-2" :title="p.æè¿°">{{ p.æè¿° }}</div>
                                </td>
                                <td class="px-4 py-5 bg-white group-hover:bg-blue-50/30 transition-colors">
                                    <div class="flex flex-wrap gap-2 justify-center min-w-[7.5rem]">
                                        <button type="button" v-if="isElectron" @click="openPlasmidExternal(p)" title="è½¯ä»¶æ‰“å¼€" class="inline-flex items-center gap-1.5 px-2 py-1.5 bg-indigo-50 text-indigo-600 text-[10px] font-bold rounded-lg hover:bg-indigo-600 hover:text-white transition-all shadow-sm justify-center btn-scale">
                                            <svg class="w-3 h-3 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
                                            <span class="hidden xl:inline">æ‰“å¼€</span>
                                        </button>
                                        <button type="button" @click="viewSequence(p)" title="æŸ¥çœ‹åºåˆ—" class="inline-flex items-center gap-1.5 px-2 py-1.5 bg-emerald-50 text-emerald-600 text-[10px] font-bold rounded-lg hover:bg-emerald-600 hover:text-white transition-all shadow-sm justify-center btn-scale">
                                            <svg class="w-3 h-3 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                                            <span class="hidden xl:inline">åºåˆ—</span>
                                        </button>
                                        <button type="button" @click="editItem(p)" title="ç¼–è¾‘" class="inline-flex items-center gap-1.5 px-2 py-1.5 bg-blue-50 text-blue-600 text-[10px] font-bold rounded-lg hover:bg-blue-600 hover:text-white transition-all shadow-sm justify-center btn-scale">
                                            <svg class="w-3 h-3 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                                            <span class="hidden xl:inline">ç¼–è¾‘</span>
                                        </button>
                                        <button type="button" @click="deleteItem(p)" title="åˆ é™¤" class="inline-flex items-center gap-1.5 px-2 py-1.5 bg-red-50 text-red-600 text-[10px] font-bold rounded-lg hover:bg-red-600 hover:text-white transition-all shadow-sm justify-center btn-scale">
                                            <svg class="w-3 h-3 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-4v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                                            <span class="hidden xl:inline">åˆ é™¤</span>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    </div>
                </div>
                <!-- åˆ†é¡µ -->
                <div class="px-6 py-5 flex justify-between items-center bg-gray-50 border-t border-gray-100">
                    <div class="text-sm text-gray-500 font-medium">
                        æ˜¾ç¤ºç¬¬ <span class="text-gray-900 font-bold">{{ (currentPage-1)*pageSize + 1 }}</span> åˆ°
                        <span class="text-gray-900 font-bold">{{ Math.min(currentPage*pageSize, filteredPlasmids.length) }}</span> æ¡
                        (å…± {{ filteredPlasmids.length }} æ¡)
                    </div>
                    <div class="flex gap-2">
                        <button type="button" @click="currentPage--" :disabled="currentPage === 1" class="px-4 py-2 bg-white border border-gray-200 rounded-lg text-sm font-bold text-gray-600 disabled:opacity-40 hover:bg-gray-50 transition-all shadow-sm">ä¸Šä¸€é¡µ</button>
                        <div class="flex items-center px-5 bg-white border border-gray-200 rounded-lg text-sm font-bold text-blue-600 shadow-sm">
                            {{ currentPage }} / {{ totalPages }}
                        </div>
                        <button type="button" @click="currentPage++" :disabled="currentPage >= totalPages" class="px-4 py-2 bg-white border border-gray-200 rounded-lg text-sm font-bold text-gray-600 disabled:opacity-40 hover:bg-gray-50 transition-all shadow-sm">ä¸‹ä¸€é¡µ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

        <!-- æ‰¹é‡è¾“å…¥å¼¹çª— (æ›¿ä»£ prompt) -->
        <transition name="modal">
            <div v-if="showBatchInputModalState" v-cloak class="fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm">
                <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md border border-gray-100 overflow-hidden">
                    <div class="px-6 py-4 border-b border-gray-100 bg-gray-50 flex justify-between items-center">
                        <h3 class="text-lg font-bold text-gray-800">{{ batchInputTitle }}</h3>
                        <button type="button" @click="showBatchInputModalState = false" class="text-gray-400 hover:text-gray-600" aria-label="å…³é—­"><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg></button>
                    </div>
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-2">{{ batchInputLabel }}</label>
                            <input v-model="batchInputValue" type="text" list="batch-input-options" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all" @keydown.enter.prevent="confirmBatchInput" ref="batchInputRef" autofocus>
                            <datalist id="batch-input-options">
                                <option v-for="opt in batchInputOptions" :key="opt" :value="opt"></option>
                            </datalist>
                        </div>
                    </div>
                    <div class="px-6 py-4 border-t border-gray-100 bg-gray-50 flex justify-end gap-3">
                        <button type="button" @click="showBatchInputModalState = false" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-100 font-medium">å–æ¶ˆ</button>
                        <button type="button" @click="confirmBatchInput" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-bold shadow-md">ç¡®å®š</button>
                    </div>
                </div>
            </div>
        </transition>

        <!-- æ‰¹é‡æ·»åŠ åˆ°é¡¹ç›®å¼¹çª— -->
        <transition name="modal">
            <div v-if="showBatchProjectModal" v-cloak class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm">
                <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg border border-gray-100">
                    <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50 rounded-t-2xl">
                        <h3 class="text-lg font-bold text-gray-800">æ‰¹é‡æ·»åŠ åˆ°é¡¹ç›®</h3>
                                        <button type="button" @click="showBatchProjectModal = false" class="text-gray-400 hover:text-gray-600 transition-colors" aria-label="å…³é—­">
                            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                        </button>
                    </div>
                    <div class="p-6">
                        <p class="text-sm text-gray-500 mb-4">
                            å°†é€‰ä¸­çš„ <span class="font-bold text-blue-600">{{ selectedPlasmids.size }}</span> æ¡è´¨ç²’æ·»åŠ åˆ°ä»¥ä¸‹é¡¹ç›®ï¼š
                        </p>
                        <div class="p-4 bg-gray-50 border border-gray-200 rounded-lg max-h-60 overflow-y-auto">
                            <div v-if="projects && projects.length > 0" class="flex flex-col gap-2">
                                <label v-for="proj in projects" :key="proj.id" class="flex items-center gap-3 px-3 py-2 bg-white border border-gray-200 rounded-lg cursor-pointer hover:border-blue-300 hover:bg-blue-50 transition-all select-none">
                                    <input type="checkbox" :value="proj.id" v-model="batchProjectTarget" class="w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                                    <span class="text-sm text-gray-700 font-medium">{{ proj.name }}</span>
                                </label>
                            </div>
                            <div v-else class="text-gray-400 text-sm text-center py-4">
                                æš‚æ— å¯ç”¨é¡¹ç›®
                            </div>
                        </div>
                    </div>
                    <div class="px-6 py-4 bg-gray-50 rounded-b-2xl flex justify-end gap-3">
                        <button type="button" @click="showBatchProjectModal = false" class="px-4 py-2 bg-white border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-all">å–æ¶ˆ</button>
                        <button type="button" @click="submitBatchProject" class="px-4 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 shadow-md transition-all">ç¡®è®¤æ·»åŠ </button>
                    </div>
                </div>
            </div>
        </transition>

        <!-- é¡¹ç›®ç®¡ç†å¼¹çª— -->
        <transition name="modal">
            <div v-if="showProjectModal" v-cloak class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm">
                <div class="bg-white rounded-2xl shadow-2xl w-full max-w-5xl h-[85vh] flex flex-col border border-gray-100 overflow-hidden">
                    <div class="px-8 py-5 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                        <h3 class="text-xl font-bold text-gray-800 flex items-center gap-3">
                            <span class="w-10 h-10 bg-purple-100 text-purple-600 rounded-xl flex items-center justify-center shadow-sm">
                                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg>
                            </span>
                            é¡¹ç›®ç®¡ç†ä¸­å¿ƒ
                        </h3>
                        <button type="button" @click="showProjectModal = false" class="text-gray-400 hover:text-gray-600 transition-colors p-2 hover:bg-gray-200 rounded-lg" aria-label="å…³é—­">
                            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                        </button>
                    </div>
                    
                    <div class="flex-1 flex overflow-hidden">
                        <!-- å·¦ä¾§ï¼šé¡¹ç›®åˆ—è¡¨ -->
                        <div class="w-1/3 border-r border-gray-100 flex flex-col bg-gray-50/50">
                            <div class="p-4 border-b border-gray-100 space-y-3">
                                <button type="button" @click="openCreateProject" class="w-full py-2.5 bg-purple-600 text-white font-bold rounded-xl hover:bg-purple-700 shadow-lg shadow-purple-200 transition-all flex items-center justify-center gap-2">
                                    <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
                                    æ–°å»ºé¡¹ç›®
                                </button>
                                <div class="relative">
                                    <svg class="w-4 h-4 text-gray-400 absolute left-3 top-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                                    <input v-model="projectSearchQuery" type="text" placeholder="æœç´¢é¡¹ç›®..." class="w-full pl-9 pr-4 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 outline-none">
                                </div>
                            </div>
                            <div class="flex-1 overflow-y-auto p-3 space-y-2">
                                <div v-for="proj in filteredProjects" :key="proj.id" 
                                    @click="toggleProjectExpand(proj.id)"
                                    :class="['p-4 rounded-xl cursor-pointer border transition-all hover:shadow-md', expandedProjectIds.has(proj.id) ? 'bg-white border-purple-200 shadow-md ring-1 ring-purple-100' : 'bg-white border-transparent hover:border-gray-200']">
                                    <div class="flex justify-between items-start">
                                        <h4 class="font-bold text-gray-800">{{ proj.name }}</h4>
                                        <div class="flex gap-1" @click.stop>
                                            <button type="button" @click="openEditProject(proj)" class="p-1 text-gray-400 hover:text-blue-600 transition-colors" title="ç¼–è¾‘" aria-label="ç¼–è¾‘"><svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg></button>
                                            <button type="button" @click="removeProject(proj)" class="p-1 text-gray-400 hover:text-red-600 transition-colors" title="åˆ é™¤" aria-label="åˆ é™¤"><svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-4v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg></button>
                                        </div>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1 line-clamp-2">{{ proj.description || 'æ— æè¿°' }}</p>
                                    <div class="mt-3 flex justify-between items-center text-xs">
                                        <span class="bg-purple-50 text-purple-600 px-2 py-0.5 rounded-full font-medium">{{ (proj.plasmidIds || []).length }} ä¸ªè´¨ç²’</span>
                                        <span class="text-gray-400">{{ new Date(proj.updatedAt).toLocaleDateString() }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- å³ä¾§ï¼šé¡¹ç›®è¯¦æƒ…/è´¨ç²’åˆ—è¡¨ -->
                        <div class="w-2/3 bg-white flex flex-col">
                            <div v-if="Array.from(expandedProjectIds).length === 1" class="flex-1 flex flex-col h-full">
                                <template v-for="projId in Array.from(expandedProjectIds)" :key="projId">
                                    <div class="px-8 py-6 border-b border-gray-100">
                                        <div class="flex justify-between items-start mb-2">
                                            <h2 class="text-2xl font-bold text-gray-800">{{ getProjectNameById(projId) }}</h2>
                                            <span class="text-xs text-gray-400 font-mono">ID: {{ projId }}</span>
                                        </div>
                                        <p class="text-gray-600 text-sm mb-4">{{ getProjectDescriptionById(projId) || 'æš‚æ— æè¿°' }}</p>
                                        <div class="flex flex-wrap gap-2">
                                            <div v-for="member in getProjectMembersById(projId)" :key="member" class="px-2 py-1 bg-blue-50 text-blue-600 text-xs rounded-lg font-medium flex items-center gap-1">
                                                <div class="w-4 h-4 rounded-full bg-blue-200 text-blue-700 flex items-center justify-center text-[8px] font-bold">{{ member.charAt(0).toUpperCase() }}</div>
                                                {{ member }}
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="flex-1 overflow-y-auto p-6 bg-gray-50/30">
                                        <h4 class="text-sm font-bold text-gray-700 mb-4 flex items-center gap-2">
                                            <svg class="w-4 h-4 text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg>
                                            å…³è”è´¨ç²’æ¸…å• ({{ getProjectPlasmidsById(projId).length }})
                                        </h4>
                                        
                                        <div v-if="getProjectPlasmidsById(projId).length > 0" class="space-y-2">
                                            <div v-for="p in getProjectPlasmidsById(projId)" :key="p.id" class="flex items-center justify-between p-3 bg-white border border-gray-100 rounded-lg hover:border-purple-200 transition-all group">
                                                <div class="flex items-center gap-3">
                                                    <div class="w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center text-gray-500 font-bold text-xs group-hover:bg-purple-100 group-hover:text-purple-600 transition-colors">
                                                    {{ getVectorTypeChar(p) }}
                                                </div>
                                                    <div>
                                                        <div class="text-sm font-bold text-gray-800">{{ p.æ–‡ä»¶å }}</div>
                                                        <div class="text-[10px] text-gray-400">{{ p.é¶åŸºå›  || 'æ— é¶åŸºå› ' }} | {{ p.å¤§è‚ æ†èŒæŠ—æ€§ || 'æ— æŠ—æ€§' }}</div>
                                                    </div>
                                                </div>
                                                <button type="button" @click="removePlasmidFromProject(getProjectById(projId), p)" class="text-gray-300 hover:text-red-500 p-2 transition-colors" title="ä»é¡¹ç›®ä¸­ç§»é™¤" aria-label="ä»é¡¹ç›®ä¸­ç§»é™¤">
                                                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                                                </button>
                                            </div>
                                        </div>
                                        <div v-else class="text-center py-10 text-gray-400 text-sm border-2 border-dashed border-gray-200 rounded-xl">
                                            æš‚æ— å…³è”è´¨ç²’
                                        </div>
                                    </div>
                                </template>
                            </div>
                            <div v-else class="flex-1 flex flex-col items-center justify-center text-gray-400 p-10">
                                <svg class="w-16 h-16 mb-4 opacity-20" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" /></svg>
                                <p>è¯·åœ¨å·¦ä¾§é€‰æ‹©ä¸€ä¸ªé¡¹ç›®æŸ¥çœ‹è¯¦æƒ…</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </transition>

        <!-- æ–°å»º/ç¼–è¾‘é¡¹ç›®è¡¨å•å¼¹çª— -->
        <transition name="modal">
            <div v-if="showProjectForm" v-cloak class="fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm">
                <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md border border-gray-100 overflow-hidden">
                    <div class="px-6 py-4 border-b border-gray-100 bg-gray-50 flex justify-between items-center">
                        <h3 class="text-lg font-bold text-gray-800">{{ isEditingProject ? 'ç¼–è¾‘é¡¹ç›®' : 'æ–°å»ºé¡¹ç›®' }}</h3>
                        <button type="button" @click="showProjectForm = false" class="text-gray-400 hover:text-gray-600" aria-label="å…³é—­"><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg></button>
                    </div>
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">é¡¹ç›®åç§° <span class="text-red-500">*</span></label>
                            <input v-model="projectForm.name" type="text" class="w-full px-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none" placeholder="ä¾‹å¦‚ï¼šç™Œç—‡ç ”ç©¶-2024">
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">é¡¹ç›®æè¿°</label>
                            <textarea v-model="projectForm.description" rows="3" class="w-full px-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none" placeholder="ç®€è¦æè¿°é¡¹ç›®ç›®æ ‡..."></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">é¡¹ç›®æˆå‘˜</label>
                            <div class="flex flex-wrap gap-2 mb-2">
                                <span v-for="m in projectForm.members" :key="m" class="px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded-md flex items-center gap-1">
                                    {{ m }}
                                    <button type="button" @click="projectForm.members = projectForm.members.filter(x => x !== m)" class="hover:text-purple-900" aria-label="ç§»é™¤æˆå‘˜">Ã—</button>
                                </span>
                            </div>
                            <div class="flex gap-2">
                                <div class="relative flex-1">
                                    <input v-model="newMemberName" type="text" list="list-all-members" placeholder="è¾“å…¥æ–°æˆå‘˜æˆ–é€‰æ‹©" 
                                           class="w-full px-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none text-sm"
                                           @keydown.enter.prevent="addMember">
                                    <datalist id="list-all-members">
                                        <option v-for="m in availableMembers" :key="m" :value="m"></option>
                                    </datalist>
                                </div>
                                <button type="button" class="px-3 py-2 bg-purple-100 text-purple-600 rounded-lg hover:bg-purple-200 font-bold"
                                        @click="addMember">
                                    +
                                </button>
                            </div>
                            <!-- Removed select since input+datalist covers it -->
                        </div>
                    </div>
                    <div class="px-6 py-4 border-t border-gray-100 bg-gray-50 flex justify-end gap-3">
                        <button type="button" @click="showProjectForm = false" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-100 font-medium">å–æ¶ˆ</button>
                        <button type="button" @click="submitProjectForm" class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-bold shadow-md">ä¿å­˜</button>
                    </div>
                </div>
            </div>
        </transition>

        <!-- ç¼–è¾‘å¼¹çª— -->
        <transition name="modal">
            <div v-if="editingItem" v-cloak class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm">
                <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto border border-gray-100">
                    <div class="px-8 py-6 border-b border-gray-100 flex justify-between items-center sticky top-0 bg-white z-10">
                        <h3 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                            <span class="w-8 h-8 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center">
                                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                            </span>
                            ä¿®æ”¹è´¨ç²’ä¿¡æ¯
                        </h3>
                        <div class="flex items-center gap-2">
                            <button type="button" @click="saveEdit" class="text-green-500 hover:text-green-700 transition-colors p-2 hover:bg-green-50 rounded-lg" aria-label="ä¿å­˜" title="ä¿å­˜ä¿®æ”¹">
                                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
                            </button>
                            <button type="button" @click="editingItem = null" class="text-gray-400 hover:text-gray-600 transition-colors p-2 hover:bg-gray-100 rounded-lg" aria-label="å…³é—­" title="å…³é—­çª—å£">
                                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                            </button>
                        </div>
                    </div>
                    <div class="p-8 space-y-6">
                        <!-- æ¨¡å¼åˆ‡æ¢ Tabs (ä»…åœ¨æ–°å»ºæ—¶æ˜¾ç¤º) -->
                        <div v-if="editingItem && editingItem.id && editingItem.id.startsWith('plasmid_')" class="flex border-b border-gray-200 mb-2">
                            <button type="button" @click="batchMode = false" :class="['px-6 py-3 text-sm font-bold border-b-2 transition-all', !batchMode ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50']">
                                å•æ¡å½•å…¥
                            </button>
                            <button type="button" @click="batchMode = true" :class="['px-6 py-3 text-sm font-bold border-b-2 transition-all', batchMode ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50']">
                                æ‰¹é‡ç²˜è´´
                            </button>
                        </div>

                        <!-- æ‰¹é‡ç²˜è´´è§†å›¾ -->
                        <div v-if="batchMode" class="space-y-4">
                            <div class="bg-blue-50 border border-blue-100 rounded-lg p-4 mb-4">
                                <h4 class="text-sm font-bold text-blue-800 mb-2 flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                    æ‰¹é‡å¯¼å…¥è¯´æ˜
                                </h4>
                                <ul class="text-xs text-blue-700 space-y-1 list-disc list-inside">
                                    <li>è¯·å°†è´¨ç²’åç§°ç²˜è´´åˆ°ä¸‹æ–¹æ–‡æœ¬æ¡†ä¸­</li>
                                    <li>æ¯è¡Œä¸€ä¸ªåç§°ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è¯†åˆ«å±æ€§</li>
                                    <li>æ‰€æœ‰æ–°åˆ›å»ºçš„è´¨ç²’å°†ä½¿ç”¨ä¸‹æ–¹è®¾ç½®çš„é»˜è®¤æŒæœ‰äººå’Œé¡¹ç›®</li>
                                </ul>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">è´¨ç²’åç§°åˆ—è¡¨ (æ¯è¡Œä¸€ä¸ª)</label>
                                <textarea v-model="batchNames" rows="10" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all font-mono text-xs" placeholder="ä¾‹å¦‚ï¼š
pLenti-CMV-EGFP-Puro
pET28a-His-Target
..."></textarea>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t border-gray-100">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">é»˜è®¤æŒæœ‰äºº</label>
                                    <input v-model="editForm.æŒæœ‰äºº" type="text" list="list-owners" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">é»˜è®¤é¡¹ç›®</label>
                                    <div class="p-3 bg-gray-50 border border-gray-200 rounded-lg max-h-32 overflow-y-auto">
                                        <div v-if="projects && projects.length > 0" class="flex flex-wrap gap-2">
                                            <label v-for="proj in projects" :key="proj.id" class="flex items-center gap-2 px-2 py-1 bg-white border border-gray-200 rounded cursor-pointer text-xs">
                                                <input type="checkbox" :value="proj.id" v-model="editForm.é¡¹ç›®" class="w-3 h-3 text-blue-600 rounded border-gray-300">
                                                <span>{{ proj.name }}</span>
                                            </label>
                                        </div>
                                        <div v-else class="text-xs text-gray-400 text-center">æš‚æ— é¡¹ç›®</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- å•æ¡ç¼–è¾‘è§†å›¾ -->
                        <div v-show="!batchMode" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="md:col-span-2">
                                <label class="block text-sm font-bold text-gray-700 mb-2">æ–‡ä»¶å</label>
                                <div class="flex items-center gap-3">
                                    <input v-model="editForm.æ–‡ä»¶å" type="text" class="flex-1 px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                                    <button type="button" @click="manualRecognizeName" class="px-4 py-3 bg-indigo-50 text-indigo-600 text-xs font-bold rounded-lg hover:bg-indigo-600 hover:text-white transition-all shadow-sm">
                                        è‡ªåŠ¨è¯†åˆ«
                                    </button>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">è½½ä½“ç±»å‹</label>
                                <input v-model="editForm.è½½ä½“ç±»å‹" type="text" list="list-è½½ä½“ç±»å‹" placeholder="ç”¨é€—å·éš”å¼€" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">é¶åŸºå› </label>
                                <input v-model="editForm.é¶åŸºå› " type="text" list="list-é¶åŸºå› " placeholder="ç”¨é€—å·éš”å¼€" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">ç‰©ç§</label>
                                <input v-model="editForm.ç‰©ç§" type="text" list="list-ç‰©ç§" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">åŠŸèƒ½</label>
                                <input v-model="editForm.åŠŸèƒ½" type="text" list="list-åŠŸèƒ½" placeholder="ç”¨é€—å·éš”å¼€" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">å¤§è‚ æ†èŒæŠ—æ€§</label>
                                <input v-model="editForm.å¤§è‚ æ†èŒæŠ—æ€§" type="text" list="list-å¤§è‚ æ†èŒæŠ—æ€§" placeholder="ç”¨é€—å·éš”å¼€" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">å“ºä¹³åŠ¨ç‰©æŠ—æ€§</label>
                                <input v-model="editForm.å“ºä¹³åŠ¨ç‰©æŠ—æ€§" type="text" list="list-å“ºä¹³åŠ¨ç‰©æŠ—æ€§" placeholder="ç”¨é€—å·éš”å¼€" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">æ’å…¥ç±»å‹</label>
                                <input v-model="editForm.æ’å…¥ç±»å‹" type="text" list="list-æ’å…¥ç±»å‹" placeholder="å¦‚ shRNA, cDNA" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">è›‹ç™½æ ‡ç­¾</label>
                                <input v-model="editForm.è›‹ç™½æ ‡ç­¾" type="text" list="list-è›‹ç™½æ ‡ç­¾" placeholder="å¦‚ Flag, Myc, His" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">è§å…‰è›‹ç™½</label>
                                <input v-model="editForm.è§å…‰è›‹ç™½" type="text" list="list-è§å…‰è›‹ç™½" placeholder="å¦‚ EGFP, mCherry" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">å¯åŠ¨å­</label>
                                <input v-model="editForm.å¯åŠ¨å­" type="text" list="list-å¯åŠ¨å­" placeholder="å¦‚ CMV, EF1a, U6" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">å››ç¯ç´ è¯±å¯¼</label>
                                <input v-model="editForm.å››ç¯ç´ è¯±å¯¼" type="text" list="list-å››ç¯ç´ è¯±å¯¼" placeholder="æ˜¯/å¦ æˆ– è¯±å¯¼å‰‚" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">çªå˜</label>
                                <input v-model="editForm.çªå˜" type="text" list="list-çªå˜" placeholder="æè¿°çªå˜ä½ç‚¹" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-bold text-gray-700 mb-2">è´¨ç²’åºåˆ— (ATCG)</label>
                                <textarea v-model="editForm.åºåˆ—" rows="4" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all font-mono text-xs uppercase" placeholder="ç²˜è´´æˆ–è¾“å…¥ ATCG åºåˆ—..."></textarea>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-bold text-gray-700 mb-2">å®Œæ•´è·¯å¾„</label>
                                <input v-model="editForm.è·¯å¾„" type="text" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all font-mono text-xs">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-bold text-gray-700 mb-2">æè¿°è¯´æ˜</label>
                                <textarea v-model="editForm.æè¿°" rows="3" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all"></textarea>
                            </div>

                            <div class="md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">ä¿å­˜ä½ç½®</label>
                                    <input v-model="editForm.ä¿å­˜ä½ç½®" type="text" list="list-locations" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all" placeholder="ä¾‹å¦‚ï¼šå†°ç®±A-å±‚1-ç›’3">
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">æŒæœ‰äºº</label>
                                    <div class="relative flex items-center gap-2">
                                        <input v-model="editForm.æŒæœ‰äºº" type="text" list="list-owners" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all" placeholder="é€‰æ‹©æˆ–è¾“å…¥æ–°åå­—">
                                        <button type="button" @click="createHolder" class="px-3 py-3 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 hover:text-blue-600 transition-colors border border-gray-200" title="æ–°å»ºæŒæœ‰äºº">
                                            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
                                        </button>
                                    </div>
                                    <div class="flex flex-wrap gap-2 mt-2">
                                        <button type="button" @click="editForm.æŒæœ‰äºº = settings.defaultOwner || editForm.æŒæœ‰äºº" class="px-3 py-1.5 text-[10px] font-bold bg-blue-50 text-blue-600 rounded-md hover:bg-blue-600 hover:text-white transition-all">ä½¿ç”¨é»˜è®¤</button>
                                        <button type="button" @click="settings.defaultOwner = editForm.æŒæœ‰äºº || settings.defaultOwner" class="px-3 py-1.5 text-[10px] font-bold bg-emerald-50 text-emerald-600 rounded-md hover:bg-emerald-600 hover:text-white transition-all">è®¾ä¸ºé»˜è®¤</button>
                                    </div>
                                    <p class="text-[10px] text-gray-400 mt-1">è¾“å…¥æ–°åå­—å¹¶ä¿å­˜å³è‡ªåŠ¨åˆ›å»ºæ–°æŒæœ‰äºº</p>
                                </div>
                            </div>
                            <div class="md:col-span-2">
                                <div class="flex justify-between items-center mb-2">
                                    <label class="block text-sm font-bold text-gray-700">æ‰€å±é¡¹ç›®</label>
                                    <button type="button" @click="openCreateProject" class="text-xs text-blue-600 hover:text-blue-800 font-bold flex items-center gap-1">
                                        <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
                                        æ–°å»ºé¡¹ç›®
                                    </button>
                                </div>
                                <div class="p-4 bg-gray-50 border border-gray-200 rounded-lg max-h-40 overflow-y-auto">
                                    <div v-if="projects && projects.length > 0" class="flex flex-wrap gap-3">
                                        <label v-for="proj in projects" :key="proj.id" class="flex items-center gap-2 px-3 py-2 bg-white border border-gray-200 rounded-lg cursor-pointer hover:border-blue-300 hover:bg-blue-50 transition-all select-none">
                                            <input type="checkbox" :value="proj.id" v-model="editForm.é¡¹ç›®" class="w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                                            <span class="text-sm text-gray-700">{{ proj.name }}</span>
                                        </label>
                                    </div>
                                    <div v-else class="text-gray-400 text-sm text-center py-2 flex flex-col items-center gap-1">
                                        <span>æš‚æ— é¡¹ç›®</span>
                                        <button type="button" @click="openCreateProject" class="text-blue-500 hover:text-blue-700 font-bold text-xs underline">ç«‹å³æ–°å»º</button>
                                    </div>
                                </div>
                            </div>

                            <!-- å¤–éƒ¨æ•°æ®åº“å‚è€ƒ -->

                        </div>
                    </div>
                    <div class="px-8 py-6 border-t border-gray-100 bg-gray-50 flex justify-end gap-3 rounded-b-2xl">
                        <button type="button" @click="editingItem = null" class="px-6 py-2.5 text-gray-600 font-bold hover:bg-gray-200 rounded-lg transition-all">å–æ¶ˆ</button>
                        <button type="button" @click="saveEdit" class="px-8 py-2.5 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 shadow-lg shadow-blue-200 transition-all">ä¿å­˜ä¿®æ”¹</button>
                    </div>
                </div>
            </div>
        </transition>

        <!-- ç³»ç»Ÿè®¾ç½®å¼¹çª— -->
        <transition name="modal">
            <div v-if="showSettingsModal" v-cloak class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm" @click.self="showSettingsModal = false">
                <div class="bg-white rounded-2xl shadow-2xl w-full max-w-xl border border-gray-100 overflow-hidden">
                    <div class="px-8 py-6 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                        <h3 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                            <svg class="w-6 h-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                            ç³»ç»Ÿè®¾ç½®
                        </h3>
                        <button type="button" @click="showSettingsModal = false" class="text-gray-400 hover:text-gray-700 transition-colors p-2 hover:bg-gray-200 rounded-lg" aria-label="å…³é—­">
                            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                        </button>
                    </div>

                    <div class="p-8 space-y-6">
                        <!-- æ˜¾ç¤ºè®¾ç½® -->
                        <div>
                            <h4 class="text-sm font-bold text-gray-400 uppercase tracking-wider mb-4">æ˜¾ç¤ºä¸ç•Œé¢</h4>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-700 font-medium">æ¯é¡µæ˜¾ç¤ºæ¡æ•°</span>
                                    <select v-model="settings.displayConfig.itemsPerPage" class="px-3 py-1.5 border border-gray-200 rounded-lg outline-none focus:ring-2 focus:ring-blue-500">
                                        <option :value="10">10 æ¡</option>
                                        <option :value="20">20 æ¡</option>
                                        <option :value="50">50 æ¡</option>
                                        <option :value="100">100 æ¡</option>
                                    </select>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-700 font-medium">è¡¨æ ¼å¯†åº¦</span>
                                    <div class="flex bg-gray-100 p-1 rounded-lg">
                                        <button type="button" @click="settings.displayConfig.tableDensity = 'compact'" :class="['px-3 py-1 text-[10px] font-bold rounded-md transition-all', settings.displayConfig.tableDensity === 'compact' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-500 hover:text-gray-700']">ç´§å‡‘</button>
                                        <button type="button" @click="settings.displayConfig.tableDensity = 'comfortable'" :class="['px-3 py-1 text-[10px] font-bold rounded-md transition-all', settings.displayConfig.tableDensity !== 'compact' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-500 hover:text-gray-700']">èˆ’é€‚</button>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-700 font-medium">æ˜¾ç¤ºæ ‡ç­¾</span>
                                    <input type="checkbox" v-model="settings.displayConfig.showTags" class="w-5 h-5 text-blue-600 rounded border-gray-300">
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-700 font-medium">æ˜¾ç¤ºä¸“ä¸šç‰¹å¾åˆ—</span>
                                    <input type="checkbox" v-model="settings.displayConfig.columnVisibility['ä¸“ä¸šç‰¹å¾']" class="w-5 h-5 text-blue-600 rounded border-gray-300">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">é»˜è®¤æŒæœ‰äºº</label>
                                    <input v-model="settings.defaultOwner" type="text" list="list-owners" placeholder="ç”¨äºæ–°å»ºè´¨ç²’çš„é»˜è®¤æŒæœ‰äºº" class="w-full px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                                </div>
                            </div>
                        </div>

                        <!-- è¯†åˆ«è®¾ç½® -->
                        <div v-if="isElectron">
                            <h4 class="text-sm font-bold text-gray-400 uppercase tracking-wider mb-4">æ¡Œé¢ç«¯å¢å¼º</h4>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">é»˜è®¤æ‰“å¼€è½¯ä»¶è·¯å¾„ (å¯é€‰)</label>
                                    <div class="flex gap-2">
                                        <input type="text" v-model="settings.externalSoftwarePath" placeholder="å¦‚: C:\Program Files\SnapGene\SnapGene.exe" 
                                            class="flex-1 px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 outline-none transition-all">
                                        <button type="button" @click="selectExternalSoftware" class="px-4 py-2.5 bg-indigo-50 text-indigo-600 rounded-lg hover:bg-indigo-600 hover:text-white transition-all shadow-sm" aria-label="é€‰æ‹©è½¯ä»¶">
                                            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" /></svg>
                                        </button>
                                    </div>
                                    <p class="mt-1.5 text-xs text-gray-400">ç•™ç©ºåˆ™ä½¿ç”¨ç³»ç»Ÿé»˜è®¤è½¯ä»¶ã€‚æŒ‡å®šåï¼Œç‚¹å‡»â€œè½¯ä»¶æ‰“å¼€â€å°†å¼ºåˆ¶ä½¿ç”¨è¯¥ç¨‹åºã€‚</p>
                                </div>
                            </div>
                        </div>

                        <!-- è¯†åˆ«è®¾ç½® -->
                        <div>
                            <h4 class="text-sm font-bold text-gray-400 uppercase tracking-wider mb-4">è‡ªåŠ¨è¯†åˆ«é…ç½®</h4>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-700 font-medium">è‡ªåŠ¨æå–å¹¶ä¿å­˜åºåˆ—</span>
                                    <input type="checkbox" v-model="settings.recognitionConfig.saveSequence" class="w-5 h-5 text-blue-600 rounded border-gray-300">
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-700 font-medium">å¯ç”¨ NLP è¯­ä¹‰åˆ†æ</span>
                                    <input type="checkbox" v-model="settings.recognitionConfig.enableNlp" class="w-5 h-5 text-blue-600 rounded border-gray-300">
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-700 font-medium">è‡ªåŠ¨æå–é¶åŸºå› </span>
                                    <input type="checkbox" v-model="settings.recognitionConfig.extractTargetGene" class="w-5 h-5 text-blue-600 rounded border-gray-300">
                                </div>
                                <div class="pt-4 border-t border-gray-100">
                                    <h5 class="text-sm font-bold text-gray-700 mb-2">åºåˆ—æ–‡ä»¶ç»´æŠ¤</h5>
                                    <p class="text-xs text-gray-500 mb-3">å¦‚æœå‘ç°åºåˆ—æ–‡ä»¶ç¼ºå¤±æˆ– CSV å¯¼å‡ºæ— åºåˆ—ï¼Œå¯ä½¿ç”¨æ­¤åŠŸèƒ½é‡æ–°ç”Ÿæˆ</p>
                                    <button type="button" @click="regenerateAllSequences" class="w-full py-2.5 bg-emerald-50 text-emerald-600 font-bold rounded-lg hover:bg-emerald-600 hover:text-white transition-all flex items-center justify-center gap-2 border border-emerald-100">
                                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>
                                        é‡æ–°ç”Ÿæˆæ‰€æœ‰åºåˆ—æ–‡ä»¶
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- å¯¼å‡ºè®¾ç½® -->
                        <div class="pt-6 border-t border-gray-100">
                            <button type="button" @click="saveSettingsFile" class="w-full py-3 bg-blue-50 text-blue-600 font-bold rounded-xl hover:bg-blue-600 hover:text-white transition-all flex items-center justify-center gap-2">
                                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>
                                å¯¼å‡ºè®¾ç½®æ–‡ä»¶ (settings.json)
                            </button>
                            <p class="text-center text-[10px] text-gray-400 mt-2">å¯¼å‡ºåè¯·æ‰‹åŠ¨æ›¿æ¢ e:/tool/data/settings.json ä»¥å®ç°æ°¸ä¹…ä¿å­˜</p>
                        </div>
                    </div>
                    <div class="px-8 py-4 bg-gray-50 flex justify-end gap-3">
                        <button type="button" @click="showSettingsModal = false" class="px-6 py-2 bg-white border border-gray-300 text-gray-700 font-bold rounded-lg hover:bg-gray-100 transition-all">
                            å–æ¶ˆ
                        </button>
                        <button type="button" @click="showSettingsModal = false" class="px-6 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 shadow-md transition-all">
                            ç¡®å®š
                        </button>
                    </div>
                </div>
            </div>
        </transition>

        <!-- æ‰¹é‡æ“ä½œæ  -->
        <transition name="fade">
            <div v-if="selectedPlasmids.size > 0" class="fixed bottom-6 left-1/2 transform -translate-x-1/2 bg-white rounded-xl shadow-2xl border border-gray-200 px-6 py-3 flex items-center gap-4 z-40">
                <div class="text-sm text-gray-600 font-medium">
                    å·²é€‰ä¸­ <span class="text-blue-600 font-bold text-lg">{{ selectedPlasmids.size }}</span> é¡¹
                </div>
                <div class="h-6 w-px bg-gray-200"></div>
                <div class="flex items-center gap-2">
                    <button type="button" @click="openBatchProjectModal" class="px-3 py-1.5 bg-indigo-50 text-indigo-600 text-sm font-bold rounded-lg hover:bg-indigo-600 hover:text-white transition-all flex items-center gap-1">
                        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" /></svg>
                        åŠ å…¥é¡¹ç›®
                    </button>
                    <button type="button" @click="batchUpdateLocation" class="px-3 py-1.5 bg-blue-50 text-blue-600 text-sm font-bold rounded-lg hover:bg-blue-600 hover:text-white transition-all flex items-center gap-1">
                        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                        ä¿®æ”¹ä½ç½®
                    </button>
                    <button type="button" @click="batchUpdateOwner" class="px-3 py-1.5 bg-teal-50 text-teal-600 text-sm font-bold rounded-lg hover:bg-teal-600 hover:text-white transition-all flex items-center gap-1">
                        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                        ä¿®æ”¹æŒæœ‰äºº
                    </button>
                    <div class="h-6 w-px bg-gray-200 mx-1"></div>
                    <button type="button" @click="batchDelete" class="px-3 py-1.5 bg-red-50 text-red-600 text-sm font-bold rounded-lg hover:bg-red-600 hover:text-white transition-all flex items-center gap-1">
                        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-4v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                        åˆ é™¤
                    </button>
                    <button type="button" @click="selectedPlasmids.clear()" class="ml-2 text-gray-400 hover:text-gray-600 transition-colors" aria-label="æ¸…ç©ºé€‰æ‹©">
                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
            </div>
        </transition>

        <!-- åºåˆ—æŸ¥çœ‹å™¨å¼¹çª— -->
        <transition name="modal">
            <div v-if="showSequenceModal" v-cloak class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-md">
                <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col border border-gray-100 overflow-hidden">
                    <div class="px-8 py-6 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                        <div class="flex flex-col">
                            <h3 class="text-xl font-bold text-gray-800 flex items-center gap-3">
                                <span class="w-10 h-10 bg-emerald-100 text-emerald-600 rounded-xl flex items-center justify-center">
                                    <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                                </span>
                                åºåˆ—æŸ¥çœ‹å™¨
                            </h3>
                            <div class="text-xs text-gray-500 mt-1 font-mono">{{ currentSequenceFileName }} (é•¿åº¦: {{ currentSequenceLength }} bp)</div>
                        </div>
                        <div class="flex items-center gap-3">
                            <div class="flex items-center gap-2 mr-4 bg-white px-3 py-1.5 rounded-lg border border-gray-200">
                                <label class="flex items-center gap-1.5 text-xs font-bold text-gray-500 cursor-pointer">
                                    <input type="checkbox" v-model="sequenceViewerOptions.coloring" class="w-4 h-4 rounded border-gray-300">
                                    ATCG ç€è‰²
                                </label>
                                <label class="flex items-center gap-1.5 text-xs font-bold text-gray-500 cursor-pointer ml-2">
                                    <input type="checkbox" v-model="sequenceViewerOptions.showNumbers" class="w-4 h-4 rounded border-gray-300">
                                    æ˜¾ç¤ºç¼–å·
                                </label>
                            </div>
                            <button type="button" @click="showSequenceModal = false" class="text-gray-400 hover:text-gray-600 transition-colors" aria-label="å…³é—­">
                                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                            </button>
                        </div>
                    </div>
                    <div class="flex-1 overflow-auto bg-slate-50 p-8 font-mono text-sm leading-relaxed tracking-widest break-all select-all scrollbar-thin">
                        <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-inner min-h-full">
                            <template v-if="sequenceViewerOptions.coloring">
                                <span v-for="(char, i) in currentSequence" :key="i" 
                                    :class="[
                                        char === 'A' ? 'text-red-500' : 
                                        char === 'T' ? 'text-blue-500' : 
                                        char === 'C' ? 'text-green-500' : 
                                        char === 'G' ? 'text-orange-500' : 'text-gray-400',
                                        'inline-block'
                                    ]">
                                    <span v-if="sequenceViewerOptions.showNumbers && i % 50 === 0" class="absolute -left-1 text-[9px] text-gray-300 pointer-events-none select-none">{{ i + 1 }}</span>
                                    {{ char }}
                                </span>
                            </template>
                            <template v-else>
                                {{ currentSequence }}
                            </template>
                        </div>
                    </div>
                    <div class="px-8 py-6 border-t border-gray-100 bg-gray-50 flex justify-between items-center">
                        <div class="flex gap-2">
                            <button type="button" v-if="isElectron && currentSequence" @click="openSequenceExternal" class="px-4 py-2 bg-indigo-50 text-indigo-600 text-xs font-bold rounded-lg hover:bg-indigo-600 hover:text-white transition-all shadow-sm flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
                                å¤–éƒ¨è½¯ä»¶æ‰“å¼€
                            </button>
                            <button type="button" @click="copySequence" class="px-4 py-2 bg-blue-50 text-blue-600 text-xs font-bold rounded-lg hover:bg-blue-600 hover:text-white transition-all shadow-sm flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" /></svg>
                                å¤åˆ¶åºåˆ—
                            </button>
                        </div>
                        <button type="button" @click="showSequenceModal = false" class="px-8 py-2.5 bg-gray-800 text-white font-bold rounded-lg hover:bg-black shadow-lg transition-all">å…³é—­</button>
                    </div>
                </div>
            </div>
        </transition>

        <!-- è‡ªåŠ¨åŒ¹é…å»ºè®®åˆ—è¡¨ -->
        <datalist v-for="(list, key) in suggestions" :key="'list-'+key" :id="'list-'+key">
            <option v-for="item in list" :key="item" :value="item"></option>
        </datalist>
        <datalist id="list-locations">
            <option v-for="loc in uniqueLocations" :key="loc" :value="loc"></option>
        </datalist>
        <datalist id="list-owners">
            <option v-for="m in uniqueHolders" :key="m" :value="m"></option>
        </datalist>

        <!-- æ‰¹é‡å¯¼å…¥å¼¹çª— -->
        <transition name="modal">
            <div v-if="showBatchModal" v-cloak class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-md">
                <div v-cloak class="bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col border border-gray-100">
                    <div class="px-8 py-6 border-b border-gray-100 flex justify-between items-center bg-gray-50 rounded-t-2xl">
                        <h3 class="text-xl font-bold text-gray-800 flex items-center gap-3">
                            <span class="w-10 h-10 bg-indigo-100 text-indigo-600 rounded-xl flex items-center justify-center">
                                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" /></svg>
                            </span>
                            æ‰¹é‡è¯†åˆ«ä¸å¯¼å…¥ (ç¡®è®¤è¯†åˆ«ç»“æœ)
                        </h3>
                        <div class="flex items-center gap-4">
                            <div v-if="isElectron" v-cloak class="flex items-center gap-2 px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-bold border border-green-200">
                                <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                                æ¡Œé¢ä¸“ä¸šæ¨¡å¼ (å·²å¼€å¯ç»å¯¹è·¯å¾„æ”¯æŒ)
                            </div>
                            <div class="text-sm text-gray-500" v-if="batchImportItems">å·²é€‰ <span class="text-indigo-600 font-bold">{{ selectedBatchCount }}</span> / {{ batchImportItems.length }} æ¡è®°å½•</div>
                            <button type="button" @click="showBatchModal = false" class="text-gray-400 hover:text-gray-600 transition-colors" aria-label="å…³é—­">
                                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                            </button>
                        </div>
                    </div>

                    <div class="px-8 py-3 bg-green-50 border-b border-green-100 flex items-center justify-between">
                        <div class="flex items-center gap-2 text-green-700 font-bold text-xs">
                            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
                            å·²é€šè¿‡æ¡Œé¢åŸç”Ÿæ¥å£æŠ“å–çœŸå®ç‰©ç†è·¯å¾„ï¼Œæ— éœ€æ‰‹åŠ¨è¡¥å…¨
                        </div>
                    </div>

                    <!-- Tabs -->
                    <div class="px-8 py-0 flex border-b border-gray-200 bg-gray-50/50">
                        <button type="button" 
                            @click="batchTab = 'new'" 
                            :class="['px-6 py-3 font-bold text-sm border-b-2 transition-colors flex items-center gap-2', batchTab === 'new' ? 'border-indigo-600 text-indigo-600' : 'border-transparent text-gray-500 hover:text-gray-700']">
                            <span>æ–°å¢å¯¼å…¥</span>
                            <span class="px-2 py-0.5 rounded-full bg-gray-100 text-xs text-gray-600">{{ newBatchCount }}</span>
                        </button>
                        <button type="button" 
                            @click="batchTab = 'update'" 
                            :class="['px-6 py-3 font-bold text-sm border-b-2 transition-colors flex items-center gap-2', batchTab === 'update' ? 'border-amber-500 text-amber-600' : 'border-transparent text-gray-500 hover:text-gray-700']">
                            <span>æ›´æ–°/å†²çª</span>
                            <span class="px-2 py-0.5 rounded-full bg-amber-100 text-xs text-amber-600">{{ updateBatchCount }}</span>
                        </button>
                    </div>

                    <div class="flex-1 overflow-auto p-4">
                        <div v-if="batchImportItems.length === 0" class="flex flex-col items-center justify-center py-20 text-gray-400">
                            <div class="w-16 h-16 border-4 border-indigo-100 border-t-indigo-600 rounded-full animate-spin mb-4"></div>
                            <p class="text-lg font-medium animate-pulse">æ­£åœ¨æ·±åº¦è¯†åˆ«è´¨ç²’ç‰¹å¾...</p>
                        </div>
                        <table v-else class="min-w-full divide-y divide-gray-200 text-xs">
                            <thead class="bg-gray-50 sticky top-0 z-10">
                                <tr>
                                    <th class="px-4 py-3 text-left w-10">
                                        <input type="checkbox" 
                                            :checked="isBatchAllSelected" 
                                            @change="toggleAllBatchItems($event.target.checked)" 
                                            class="w-4 h-4 rounded border-gray-300">
                                    </th>
                                    <th class="px-4 py-3 text-left font-bold text-gray-500 uppercase">æ–‡ä»¶å</th>
                                    <th class="px-4 py-3 text-left font-bold text-gray-500 uppercase">è·¯å¾„ (ç»å¯¹è·¯å¾„)</th>
                                    <th class="px-4 py-3 text-left font-bold text-gray-500 uppercase">åŸºæœ¬ä¿¡æ¯ (è½½ä½“/ç‰©ç§/ç±»å‹)</th>
                                    <th class="px-4 py-3 text-left font-bold text-gray-500 uppercase">åŸºå› /å¯åŠ¨å­/æ ‡ç­¾</th>
                                    <th class="px-4 py-3 text-left font-bold text-gray-500 uppercase">æŠ—æ€§/è¯±å¯¼</th>
                                    <th class="px-4 py-3 text-left font-bold text-gray-500 uppercase">ä½ç½®/äººå‘˜/é¡¹ç›®</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-100">
                                <tr v-for="item in batchImportItems" :key="item.æ–‡ä»¶å" 
                                    v-show="(batchTab === 'new' && !item.isDuplicate) || (batchTab === 'update' && item.isDuplicate)"
                                    :class="['hover:bg-gray-50 transition-colors', item.isDuplicate ? 'bg-amber-50/50' : '']">
                                    <td class="px-4 py-3 text-center"><input type="checkbox" v-model="item.selected" class="w-4 h-4 rounded border-gray-300"></td>
                                    <td class="px-4 py-3">
                                        <input type="text" v-model="item.æ–‡ä»¶å" class="w-full bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none font-bold py-1">
                                        <div v-if="item.isDuplicate" class="text-[9px] text-amber-600 mt-0.5 flex items-center gap-1 font-bold italic">
                                            <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"/></svg>
                                            æ•°æ®åº“å·²å­˜åœ¨
                                        </div>
                                    </td>
                                    <td class="px-4 py-3">
                                        <input type="text" v-model="item.è·¯å¾„" class="w-full bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none text-gray-500 italic py-1" placeholder="è¯·è¡¥å…¨å®Œæ•´è·¯å¾„...">
                                    </td>
                                    <td class="px-4 py-3 space-y-1">
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">è½½ä½“:</span><input type="text" v-model="item.è½½ä½“ç±»å‹" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-purple-600 font-medium"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">ç‰©ç§:</span><input type="text" v-model="item.ç‰©ç§" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-green-600 font-medium"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">ç±»å‹:</span><input type="text" v-model="item.æ’å…¥ç±»å‹" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-blue-500 font-medium"></div>
                                    </td>
                                    <td class="px-4 py-3 space-y-1">
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">é¶åŸºå› :</span><input type="text" v-model="item.é¶åŸºå› " class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 font-bold"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">å¯åŠ¨å­:</span><input type="text" v-model="item.å¯åŠ¨å­" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-gray-600"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">æ ‡ç­¾:</span><input type="text" v-model="item.è›‹ç™½æ ‡ç­¾" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-amber-600"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">è§å…‰:</span><input type="text" v-model="item.è§å…‰è›‹ç™½" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-emerald-500"></div>
                                    </td>
                                    <td class="px-4 py-3 space-y-1">
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">å¤§è‚ æŠ—:</span><input type="text" v-model="item.å¤§è‚ æ†èŒæŠ—æ€§" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-orange-600"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">å“ºä¹³æŠ—:</span><input type="text" v-model="item.å“ºä¹³åŠ¨ç‰©æŠ—æ€§" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-blue-600"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">è¯±å¯¼:</span><input type="text" v-model="item.å››ç¯ç´ è¯±å¯¼" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-red-500"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">çªå˜:</span><input type="text" v-model="item.çªå˜" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-rose-500"></div>
                                    </td>
                                    <td class="px-4 py-3 space-y-1">
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">ä½ç½®:</span><input type="text" v-model="item.ä¿å­˜ä½ç½®" list="list-locations" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-gray-600"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">äººå‘˜:</span><input type="text" v-model="item.æŒæœ‰äºº" list="list-owners" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-gray-600"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-12 shrink-0">é¡¹ç›®:</span>
                                            <select v-model="item.é¡¹ç›®" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-xs">
                                                <option value="">(æ— )</option>
                                                <option v-for="proj in projects" :key="proj.id" :value="proj.id">{{ proj.name }}</option>
                                            </select>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="px-8 py-6 border-t border-gray-100 bg-gray-50 flex justify-between items-center rounded-b-2xl">
                        <div class="text-xs text-gray-400 max-w-md">
                            <span class="font-bold text-gray-500">æç¤ºï¼š</span> æ‚¨å¯ä»¥ç›´æ¥åœ¨è¡¨æ ¼ä¸­ä¿®æ”¹è¯†åˆ«ç»“æœã€‚å¯¹äºé‡å¤é¡¹ï¼Œç³»ç»Ÿé»˜è®¤ä¸å‹¾é€‰å¯¼å…¥ã€‚
                        </div>
                        <div class="flex gap-3">
                            <button type="button" @click="showBatchModal = false" class="px-6 py-2.5 border border-gray-300 text-gray-600 font-bold rounded-xl hover:bg-gray-100 transition-all">å–æ¶ˆ</button>
                            <button v-if="batchTab === 'new'" type="button" @click="saveBatchImport" class="px-10 py-2.5 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 shadow-lg shadow-indigo-200 transition-all flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
                                ç¡®è®¤å¯¼å…¥å¹¶ä¿å­˜
                            </button>
                            <button v-if="batchTab === 'update'" type="button" @click="saveBatchUpdate" class="px-10 py-2.5 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-200 transition-all flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>
                                ç¡®è®¤æ›´æ–°å¹¶ä¿å­˜
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </transition>

        <!-- Batch Paste Preview Modal -->
        <transition name="modal">
            <div v-if="showBatchPreview" v-cloak class="fixed inset-0 z-[60] flex items-center justify-center p-8 bg-black/50 backdrop-blur-sm">
                <div class="bg-white w-full max-w-7xl max-h-full rounded-2xl shadow-2xl flex flex-col overflow-hidden animate-fade-in-up">
                    <div class="px-8 py-6 border-b border-gray-100 flex items-center justify-between bg-gradient-to-r from-indigo-50 to-white">
                        <div>
                            <h3 class="text-2xl font-black text-gray-800">æ‰¹é‡å¯¼å…¥ç¡®è®¤</h3>
                            <p class="text-sm text-gray-500 mt-1">è¯·ç¡®è®¤è¯†åˆ«ç»“æœï¼Œç›´æ¥ä¿®æ”¹è¡¨æ ¼å†…å®¹è¿›è¡Œæ›´æ­£</p>
                        </div>
                        <div class="flex items-center gap-4">
                            <div class="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-lg text-xs font-bold">
                                å…± {{ batchPreviewList.length }} æ¡è®°å½•
                            </div>
                        </div>
                    </div>

                    <div class="flex-1 overflow-auto p-0">
                        <table class="min-w-full divide-y divide-gray-200 text-xs">
                            <thead class="bg-gray-50 sticky top-0 z-10">
                                <tr>
                                    <th class="px-4 py-3 text-left font-bold text-gray-500 uppercase">æ–‡ä»¶å</th>
                                    <th class="px-4 py-3 text-left font-bold text-gray-500 uppercase">åŸºæœ¬ä¿¡æ¯</th>
                                    <th class="px-4 py-3 text-left font-bold text-gray-500 uppercase">åŸºå› /å¯åŠ¨å­/æ ‡ç­¾</th>
                                    <th class="px-4 py-3 text-left font-bold text-gray-500 uppercase">æŠ—æ€§/è¯±å¯¼</th>
                                    <th class="px-4 py-3 text-left font-bold text-gray-500 uppercase">ä½ç½®/äººå‘˜/é¡¹ç›®</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-100 bg-white">
                                <tr v-for="(item, index) in batchPreviewList" :key="index" class="hover:bg-gray-50">
                                    <td class="px-4 py-3 align-top">
                                        <input type="text" v-model="item.æ–‡ä»¶å" class="w-full bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none font-bold py-1">
                                    </td>
                                    <td class="px-4 py-3 space-y-1 align-top">
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-8 shrink-0">è½½ä½“:</span><input type="text" v-model="item.è½½ä½“ç±»å‹" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-purple-600 font-medium"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-8 shrink-0">ç‰©ç§:</span><input type="text" v-model="item.ç‰©ç§" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-green-600 font-medium"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-8 shrink-0">ç±»å‹:</span><input type="text" v-model="item.æ’å…¥ç±»å‹" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-blue-500 font-medium"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-8 shrink-0">åŠŸèƒ½:</span><input type="text" v-model="item.åŠŸèƒ½" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-gray-600"></div>
                                    </td>
                                    <td class="px-4 py-3 space-y-1 align-top">
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-10 shrink-0">é¶åŸºå› :</span><input type="text" v-model="item.é¶åŸºå› " class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 font-bold"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-10 shrink-0">å¯åŠ¨å­:</span><input type="text" v-model="item.å¯åŠ¨å­" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-gray-600"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-10 shrink-0">æ ‡ç­¾:</span><input type="text" v-model="item.è›‹ç™½æ ‡ç­¾" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-amber-600"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-10 shrink-0">è§å…‰:</span><input type="text" v-model="item.è§å…‰è›‹ç™½" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-emerald-500"></div>
                                    </td>
                                    <td class="px-4 py-3 space-y-1 align-top">
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-10 shrink-0">å¤§è‚ :</span><input type="text" v-model="item.å¤§è‚ æ†èŒæŠ—æ€§" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-orange-600"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-10 shrink-0">å“ºä¹³:</span><input type="text" v-model="item.å“ºä¹³åŠ¨ç‰©æŠ—æ€§" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-blue-600"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-10 shrink-0">è¯±å¯¼:</span><input type="text" v-model="item.å››ç¯ç´ è¯±å¯¼" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-red-500"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-10 shrink-0">çªå˜:</span><input type="text" v-model="item.çªå˜" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-rose-500"></div>
                                    </td>
                                    <td class="px-4 py-3 space-y-1 align-top">
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-8 shrink-0">ä½ç½®:</span><input type="text" v-model="item.ä¿å­˜ä½ç½®" list="list-locations" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-gray-600"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-8 shrink-0">äººå‘˜:</span><input type="text" v-model="item.æŒæœ‰äºº" list="list-owners" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-gray-600"></div>
                                        <div class="flex gap-1"><span class="text-[9px] text-gray-400 w-8 shrink-0">é¡¹ç›®:</span>
                                            <select v-model="item.é¡¹ç›®" class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 focus:outline-none py-0 text-xs">
                                                <option value="">(æ— )</option>
                                                <option v-for="proj in (projectManager && projectManager.projects ? projectManager.projects : [])" :key="proj.id" :value="proj.id">{{ proj.name }}</option>
                                            </select>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="px-8 py-6 border-t border-gray-100 bg-gray-50 flex justify-end gap-3">
                        <button type="button" @click="cancelBatchImport" class="px-6 py-2.5 border border-gray-300 text-gray-600 font-bold rounded-xl hover:bg-gray-100 transition-all">å–æ¶ˆ</button>
                        <button type="button" @click="confirmBatchImport" class="px-10 py-2.5 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 shadow-lg shadow-indigo-200 transition-all">ç¡®è®¤å¯¼å…¥</button>
                    </div>
                </div>
            </div>
        </transition>

        <!-- ç³»ç»Ÿæ—¥å¿—å¼¹çª— -->
        <transition name="modal">
            <div v-if="showLogModal" v-cloak class="fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm">
                <div class="bg-slate-900 rounded-2xl shadow-2xl w-full max-w-4xl h-[80vh] flex flex-col border border-slate-700">
                    <div class="px-8 py-6 border-b border-slate-700 flex justify-between items-center bg-slate-800 rounded-t-2xl">
                        <h3 class="text-xl font-bold text-white flex items-center gap-3">
                            <span class="w-8 h-8 bg-blue-500/20 text-blue-400 rounded-lg flex items-center justify-center">
                                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
                            </span>
                            ç³»ç»Ÿè¿è¡Œç›‘æ§æ—¥å¿—
                        </h3>
                        <div class="flex gap-2">
                            <button type="button" @click="systemLogs.splice(0)" class="px-3 py-1.5 text-xs text-slate-400 hover:text-white hover:bg-slate-700 rounded-md transition-all">æ¸…ç©ºæ—¥å¿—</button>
                            <button type="button" @click="showLogModal = false" class="text-slate-400 hover:text-white transition-colors" aria-label="å…³é—­">
                                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                            </button>
                        </div>
                    </div>
                    <div class="flex-1 overflow-auto p-4">
                        <div v-if="systemLogs.length === 0" class="text-slate-500 italic text-center py-20">æš‚æ— ç³»ç»Ÿè¿è¡Œæ—¥å¿—...</div>
                        <div v-for="(log, idx) in systemLogs" :key="idx" :class="['flex gap-3 px-3 py-1.5 rounded border-l-4 transition-colors', log.type === 'error' ? 'bg-red-500/10 border-red-500 text-red-400' : log.type === 'warn' ? 'bg-amber-500/10 border-amber-500 text-amber-400' : 'bg-slate-800/50 border-blue-500 text-slate-300 hover:bg-slate-800']">
                            <span class="text-slate-500 whitespace-nowrap">[{{ log.time }}]</span>
                            <span :class="['font-bold px-1 rounded uppercase text-[10px]', log.type === 'error' ? 'bg-red-500 text-white' : log.type === 'warn' ? 'bg-amber-500 text-black' : 'bg-blue-500 text-white']">{{ log.type }}</span>
                            <span class="break-all">{{ log.msg }}</span>
                        </div>
                    </div>
                    <div class="px-8 py-4 border-t border-slate-700 bg-slate-800/50 rounded-b-2xl text-xs text-slate-500 flex justify-between items-center">
                        <span>æ—¥å¿—ä»…ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œåˆ·æ–°é¡µé¢åå°†æ¸…ç©º</span>
                        <span>å…± {{ systemLogs.length }} æ¡è¿è¡Œè®°å½•</span>
                    </div>
                </div>
            </div>
        </transition>

        <!-- CSV å¯¼å‡ºè®¾ç½®å¼¹çª— -->
        <transition name="modal">
            <div v-if="showExportModal" v-cloak class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm">
                <div v-cloak class="bg-white rounded-2xl shadow-2xl w-full max-w-md flex flex-col border border-gray-100 overflow-hidden">
                    <div class="px-8 py-6 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                        <h3 class="text-xl font-bold text-gray-800 flex items-center gap-3">
                            <span class="w-8 h-8 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center">
                                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2m3.293-7.707a1 1 0 011.414 0L9 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" /></svg>
                            </span>
                            CSV å¯¼å‡ºè®¾ç½®
                        </h3>
                        <button type="button" @click="showExportModal = false" class="text-gray-400 hover:text-gray-600 transition-colors" aria-label="å…³é—­">
                            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                        </button>
                    </div>
                    <div class="p-8">
                        <div class="flex justify-between items-center mb-4">
                            <label class="block text-sm font-bold text-gray-700">é€‰æ‹©è¦å¯¼å‡ºçš„å­—æ®µ</label>
                            <div class="flex gap-2">
                                <button type="button" @click="toggleAllExportFields(true)" class="text-xs text-blue-600 hover:underline">å…¨é€‰</button>
                                <button type="button" @click="toggleAllExportFields(false)" class="text-xs text-gray-400 hover:underline">æ¸…ç©º</button>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-3 max-h-[40vh] overflow-y-auto pr-2 scrollbar-thin">
                            <label v-for="field in exportFields" :key="field.id" class="flex items-center gap-3 p-3 border border-gray-100 rounded-xl hover:bg-blue-50 cursor-pointer transition-all group">
                                <input type="checkbox" v-model="field.selected" class="w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                                <span class="text-sm text-gray-700 group-hover:text-blue-700 transition-colors">{{ field.label }}</span>
                            </label>
                        </div>
                        <p class="text-[10px] text-gray-400 mt-4 italic text-center" v-if="filteredPlasmids">ç³»ç»Ÿå°†æŒ‰æ‰€é€‰å­—æ®µé¡ºåºå¯¼å‡ºå½“å‰ç­›é€‰å‡ºçš„ {{ filteredPlasmids.length }} æ¡è®°å½•</p>
                    </div>
                    <div class="px-8 py-6 border-t border-gray-100 bg-gray-50 flex justify-end gap-3">
                        <button type="button" @click="showExportModal = false" class="px-6 py-2.5 border border-gray-300 text-gray-600 font-bold rounded-xl hover:bg-gray-100 transition-all">å–æ¶ˆ</button>
                        <button type="button" @click="downloadCSV" class="px-8 py-2.5 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 shadow-lg shadow-blue-200 transition-all flex items-center gap-2 btn-scale">
                            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" /></svg>
                            å¼€å§‹å¯¼å‡º
                        </button>
                    </div>
                </div>
            </div>
        </transition>

<!-- Duplicate Modal Removed -->

        <!-- Toast æç¤º -->
        <div id="toast" class="fixed bottom-10 left-1/2 transform -translate-x-1/2 bg-gray-800/95 text-white px-8 py-4 rounded-2xl shadow-2xl text-sm font-bold transition-all duration-300 opacity-0 pointer-events-none z-[100] flex items-center gap-3 border border-gray-700">
            <svg class="w-5 h-5 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
            <span id="toast-text">è·¯å¾„å·²å¤åˆ¶</span>
        </div>
    </div>
</div>

    <!-- ç³»ç»Ÿåˆå§‹åŒ–åŠ è½½å±‚ (Vue æŒ‚è½½å‰å¯è§) -->
    <div class="init-loader" id="init-loader">
        <div class="w-16 h-16 border-4 border-blue-100 border-t-blue-600 rounded-full animate-spin mb-4"></div>
        <div class="text-center">
            <p class="text-gray-500 font-bold animate-pulse text-lg">ç³»ç»Ÿæ­£åœ¨å¯åŠ¨ä¸­...</p>
            <p class="text-gray-400 text-sm mt-1">æ­£åœ¨åˆå§‹åŒ–æ¡Œé¢ç«¯ä¸šåŠ¡é€»è¾‘</p>
            <p class="text-[10px] text-gray-400 mt-4 opacity-50">å¦‚æœé•¿æ—¶é—´æ— å“åº”ï¼Œè¯·æ£€æŸ¥ data/app_debug.log</p>
        </div>
    </div>

    <script src="js/utils.js"></script>
    <script src="js/recognition.js"></script>
    <script src="js/data-service.js"></script>
    <script src="js/project-window.js"></script>
    <script src="js/db-manager.js"></script>
    <script src="js/batch-logic.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
