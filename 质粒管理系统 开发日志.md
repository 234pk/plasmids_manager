# 质粒管理系统 开发日志

## 2026-02-06
### 已完成修改
- **i18n 优化**: 修复了语言切换后部分界面仍显示中文的问题。
- **识别算法优化**: 
    - 扩充了 `noiseWords` 噪声词库，减少了载体名称（如 pAc5.1）被误识别为靶基因的情况。
    - 调整了 `vectorPatterns` 的优先级，优先识别 `pSpCas9` 和 `PX458` 等特定载体。
    - 增加了载体标准化规则，如 `pLKO.1` -> `pLKO`, `pcDNA3.1` -> `pcDNA3`。
    - 增强了特定载体（如 psPAX2, pMD2.G）的抗性和靶基因推断逻辑。
- **测试框架**: 建立了基于网络数据的测试集 `web_plasmids.json`，并将识别准确率从约 60% 提升至 72%。

## 2026-02-07
### 已完成修改
- **UI/UX 增强**:
    - 将 12 个质粒属性输入框替换为可勾选列表，支持快速选择。
    - 支持在列表中直接添加新值，具备自动去重逻辑。
    - 优化了批量导入的数据持久化逻辑，仅保留用户勾选的值。
    - 调整了批量导入模态框宽度（最大 98vw），解决了长文件名显示不全的问题。
- **识别逻辑优化**:
    - 修复了 `recognition.js` 和 `batch-logic.js` 中的 `t is not defined` 引用错误。
    - 强化了标签冗余过滤（如处理 `3xHA` 与 `HA` 同时存在、`Flag V5` 冗余等情况）。
    - 实现了文件名与文件内容识别结果的交叉验证，显著提升 GenBank 文件特征识别的准确性。
    - 优化了 `generateDescription` 逻辑，支持多语言描述生成。
- **国际化 (i18n) 与乱码修复**:
    - 完成了新用户引导界面的全面国际化，替换了 `app.js` 中的硬编码内容。
    - 修复了 `translations_data.js` 中部分带有冗余单引号或未处理三元表达式的文本。
    - 为 HTML 中的脚本加载显式指定了 `charset="utf-8"`，解决了 Windows 下可能的标题乱码问题。
- **文档与工程化**:
    - 全面更新了中英文 README 文件 (`README.md`, `README.en.md`)，详细说明了核心功能、技术栈、项目结构及快速开始指南。
    - 修复了 macOS 构建失败问题：通过禁用 `hardenedRuntime`、显式跳过签名 (`CSC_SKIP_SIGNING`) 以及修正图标配置，解决了 CI 环境下缺失 Apple Team ID 导致的打包错误。
    - 建立了 `.github/workflows/release.yml`，支持通过 GitHub Actions 自动进行跨平台（Windows, macOS）打包发布。
    - 补充了 macOS 权限管理所需的 `plist` 配置文件，确保 macOS 兼容性。

- **UI 一致性与体验优化**:
    - 统一了“新建质粒”、“批量粘贴”、“批量导入”的交互模式，均采用“可勾选列表 + 智能下拉框”设计，支持回车键快速添加。
    - 修复了 CSV 导出弹窗中字段标签不可见的问题（国际化 Key 映射修复），并验证了全选/反选功能。
    - 解决了主界面排序下拉框中的中文乱码问题。
    - 为“新建质粒”界面的智能识别按钮添加了功能说明 Tooltip。
    - 实现了最近打开数据库的自动记录与加载功能（支持文件选择与拖拽）。

- **设置与帮助系统增强**:
    - 优化了“设置”面板布局，增加了最大高度限制和内部滚动条，适应小屏幕显示。
    - 实现了**数据库历史记录管理**功能：系统会自动记录最近打开的 10 个数据库，并提供专门的模态框进行查看、快速加载和清空记录。
    - 集成了**双语帮助文档系统**：新增“使用帮助”模态框，提供“功能简介”、“导入与识别”、“搜索技巧”、“常见问题”等板块，支持中英双语切换。
    - 修复了 `app.js` 中 `save-app-history` 仅保存最后路径而未保存历史列表的逻辑缺陷。
    - **移除不稳定识别逻辑**: 应用户要求，移除了基于文件名正则模式猜测载体类型（如 `p[A-Z]...`）的逻辑，避免将启动子或普通名称误识别为载体。

### 待做事项 (TODO)
- [ ] **识别准确率持续优化**: 进一步优化复杂文件名（如包含特殊版本号）的载体提取逻辑。
- [ ] **UI 性能优化**: 当质粒数据量极大时，优化表格的渲染性能。
- [ ] **离线同步功能**: 考虑增加多端数据同步或备份方案。
